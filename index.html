<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="format-detection" content="telephone=no">
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4169e1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="TAU Africa">
<link rel="apple-touch-icon" href="icon-192.png">
    <title>TAU AFRICA INTERNATIONAL</title>
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    <style>
        /* Safari/iOS Compatibility Fixes */
* {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
}

body {
    -webkit-overflow-scrolling: touch;
    overflow-scrolling: touch;
}

/* Fix buttons on iOS */
button, input[type="submit"], input[type="button"] {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    cursor: pointer;
}

/* Fix inputs on iOS */
input, select, textarea {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    border-radius: 10px;
}

/* Fix modal scrolling on iOS */
.modal {
    -webkit-overflow-scrolling: touch;
    overflow-scrolling: touch;
}

.modal-content {
    -webkit-overflow-scrolling: touch;
    overflow-scrolling: touch;
}

/* Fix for Safari date input */
input[type="date"] {
    -webkit-appearance: none;
    appearance: none;
    min-height: 44px;
}

/* Fix button clicks on iOS */
.btn, .level-btn, .house-btn, .corporate-btn {
    cursor: pointer;
    -webkit-user-select: none;
    user-select: none;
    touch-action: manipulation;
}
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298, #87ceeb);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #000080, #4169e1, #87ceeb);
            color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .emancipation-scroll {
            position: absolute;
            bottom: 5px;
            left: 0;
            width: 100%;
            height: 20px;
            overflow: hidden;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 10px;
        }

        .emancipation-text {
            display: inline-block;
            white-space: nowrap;
            font-size: 12px;
            font-weight: bold;
            color: #ffd700;
            animation: scrollText 15s linear infinite;
            line-height: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        @keyframes scrollText {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .logo {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #87ceeb, #4169e1);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            border: 4px solid #ffd700;
        }

        .main-title {
            font-size: 2.8rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            letter-spacing: 2px;
        }

        .vision {
            font-size: 1.2rem;
            font-style: italic;
            opacity: 0.9;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .social-link {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .social-link:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .wings-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .wing {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .wing:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .auffi {
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .valenta {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .wing-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .wing-description {
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .houses-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .house-btn, .corporate-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: bold;
        }

        .house-btn:hover, .corporate-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .galaxy-banner {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            margin-top: 15px;
        }

        .main-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .section {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }

        .section:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2a5298;
            margin-bottom: 15px;
            text-align: center;
        }

        .btn {
            background: linear-gradient(45deg, #4169e1, #87ceeb);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
            display: inline-block;
            text-decoration: none;
        }

        .btn:hover {
            background: linear-gradient(45deg, #2a5298, #4169e1);
            transform: scale(1.05);
        }

        .btn-register {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            font-size: 1.1rem;
            padding: 15px 30px;
        }

        .btn-kabiru {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            font-weight: bold;
            width: 100%;
            padding: 15px;
            margin-top: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            overflow-y: auto;
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 95vh;
            overflow-y: auto;
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 15px;
        }

        .close:hover {
            color: #000;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2a5298;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: #4169e1;
            outline: none;
        }

        .payment-info {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .level-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .level-btn {
            padding: 10px;
            border: 2px solid #4169e1;
            background: rgba(65, 105, 225, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .level-btn.selected {
            background: #4169e1;
            color: white;
        }

        .kabiru-section {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            text-align: center;
            padding: 30px;
            border-radius: 20px;
            margin-top: 30px;
        }

        .payment-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .payment-widget {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .payment-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 16px;
            text-align: center;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4169e1;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 20px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 1001;
            display: none;
            max-width: 350px;
        }

        .success { background: #2ecc71; }
        .error { background: #e74c3c; }

        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #4169e1, #87ceeb);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        .ai-assistant {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 100;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }

        .ai-chat-window {
            position: fixed;
            bottom: 170px;
            right: 30px;
            width: 350px;
            height: 450px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            z-index: 200;
        }

        .ai-chat-header {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 15px 20px;
            border-radius: 20px 20px 0 0;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 300px;
        }

        .ai-message {
            background: #f0f0f0;
            padding: 10px 15px;
            border-radius: 15px;
            margin: 10px 0;
            max-width: 80%;
        }

        .user-message {
            background: linear-gradient(45deg, #4169e1, #87ceeb);
            color: white;
            margin-left: auto;
        }

        .ai-chat-input {
            display: flex;
            padding: 15px;
            border-top: 1px solid #eee;
        }

        .ai-chat-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }

        .ai-chat-input button {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            margin-left: 10px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .wings-container {
                grid-template-columns: 1fr;
            }
            
            .main-title {
                font-size: 2rem;
            }
            
            .houses-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-window {
                width: 90%;
                right: 5%;
                left: 5%;
            }
            
            .social-links {
                gap: 10px;
            }
            
            .social-link {
                font-size: 12px;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">üåç TAU</div>
            <h1 class="main-title">TAU AFRICA INTERNATIONAL</h1>
            <p class="vision">Community ‚Ä¢ Value ‚Ä¢ Corporate ‚Ä¢ Sovereignty</p>
            
            <!-- Social Media Links -->
            <div class="social-links">
                <a href="https://x.com/grouptauafrica?t=pFlJ-gky_A7Dp3e0lbZ5Sg&s=09" target="_blank" class="social-link">
                    üê¶ Twitter/X
                </a>
                <a href="https://www.tiktok.com/@tau.africa.nairob?_t=ZM-8zwbvmFtmt2&_r=1" target="_blank" class="social-link">
                    üéµ TikTok
                </a>
                <a href="https://youtube.com/@tauafrica8922?si=wwgxc2AvYHYwsHTh" target="_blank" class="social-link">
                    üì∫ YouTube
                </a>
                <span class="social-link" style="opacity: 0.7;">
                    üìò Facebook (Coming Soon)
                </span>
            </div>
            
            <div class="emancipation-scroll">
                <div class="emancipation-text">EMANCIPATION PROCLAMATIONS ‚Ä¢ FREEDOM FOR ALL AFRICANS ‚Ä¢ UNITY IN DIVERSITY ‚Ä¢ ECONOMIC LIBERATION ‚Ä¢ SPIRITUAL AWAKENING ‚Ä¢ SOCIAL JUSTICE</div>
            </div>
        </div>

        <!-- Two Wings -->
        <div class="wings-container">
            <!-- AUFFI Wing -->
            <div class="wing auffi">
                <h2 class="wing-title">üåç AUFFI</h2>
                <p class="wing-description">Africa Unity Freedom Fund Initiative. The Pan African Digital value Currency for uniting and awakening Africa socially, economically and spiritually. A movement that return Oloo's Sovereignty back home to Africa, bringing together the children of Oloo and the Galaxy restoration to rebuild Africa</p>
                
                <div class="houses-grid">
                    <div class="house-btn" onclick="showNotification('Galaxy 0 house - join with G0 Card!', 'success')">Galaxy 0 [Secretariat Board G0]</div>
                    <div class="house-btn" onclick="showNotification('Galaxy 1 house - join with G1 Card!', 'success')">Galaxy 1 [Representative Board]</div>
                    <div class="house-btn" onclick="showNotification('Galaxy 2 house - join with G2 Card!', 'success')">Galaxy 2 [Coordination Board  ]</div>
                    <div class="house-btn" onclick="showNotification('Galaxy 3 house - join with G3 Card!', 'success')">Galaxy 3 [Implementation Board]</div>
                </div>
                
                <div class="galaxy-banner">
                    Auffi - Pan African Trust Graph & R4<br> [REPARTRIATION - RESURRECTION-RESTORATION - RECONNECTION] (sovereignty). Our digital Ecosystem uses human & environmental values to create the Africa's Sovereign Wealth, and subsequently bring back Sovereignty to black people and humanity. join the Kabiru Mining App to mine your values in building The African digital currency (Kabiru)
                </div>
                
                <button class="btn" onclick="openModal('parSirai')">Par Sirai Center</button>
            </div>

            <!-- Valenta Wing -->
            <div class="wing valenta">
                <h2 class="wing-title">üè¢ VALENTA</h2>
                <p class="wing-description">Value Enter Africa - Our Corporate Holding company, building Kabiru Digital currency for Africa value harnessing, erecting a sustainable Kabiru digital ecosystem, & Empowering African communities through Education - Economic and Social Literacy. Come let us build our sovereignty together, and make Africa great again</p>

                <div class="houses-grid">
                    <div class="corporate-btn" onclick="openModal('corporate')">Corporate company</div>
                    <div class="corporate-btn" onclick="openModal('trustGraph')">Generation Trust Graph</div>
                    <div class="corporate-btn" onclick="openModal('foundation')">Family Foundation</div>
                    <div class="corporate-btn" onclick="openModal('holdings')">Holding Company</div>
                </div>
            </div>
        </div>

        <!-- Main Sections -->
        <div class="main-sections">
            <!-- Membership Registration -->
            <div class="section">
                <h3 class="section-title">üë• MEMBERSHIP</h3>
                <p>Join our community through TASK & TALK teams</p>
                <button class="btn btn-register" onclick="openModal('taskRegistration')">Join TASK Team</button>
                <button class="btn btn-register" onclick="openModal('talkRegistration')">Join TALK Team</button>
                <p style="margin-top: 15px; font-weight: bold; color: #e74c3c;">TASK Fee: KSH 500 | TALK Fee: KSH 2,000</p>
            </div>

            <!-- Activity Area -->
            <div class="section">
                <h3 class="section-title">üìö ACTIVITIES</h3>
                <p>Training workshops, job creation & research services</p>
                <button class="btn" onclick="openModal('training')">Join member training</button>
                <button class="btn" onclick="openModal('workshop')">Host corporate Workshop</button>
                <button class="btn" onclick="openModal('research')">Research Services</button>
                <button class="btn" onclick="openModal('jobCreation')">Job Creation workshop</button>
            </div>

            <!-- Jobs Area -->
            <div class="section">
                <h3 class="section-title">üíº TASKS</h3>
                <p>Connect job seekers with verified opportunities</p>
                <button class="btn" onclick="openModal('insertJob')">Insert value</button>
                <button class="btn" onclick="openModal('retrieveJob')">Search value</button>
                <button class="btn" onclick="openModal('availableJobs')">Browse value</button>
                <button class="btn" onclick="openModal('applyJob')">seek value</button>
            </div>

            <!-- Community -->
            <div class="section">
                <h3 class="section-title">ü§ù COMMUNITY</h3>
                <p>Community support programs</p>
                <button class="btn" onclick="openModal('community')">Join Programs</button>
                <div style="margin-top: 10px; font-size: 0.9rem;">
                    Agriculture ‚Ä¢ Climate ‚Ä¢ Environment<br>
                    Water & Sanitation ‚Ä¢ Education ‚Ä¢ Child Care
                </div>
            </div>

            <!-- Interactive Forum -->
            <div class="section">
                <h3 class="section-title">üí¨ MEMBER FORUM</h3>
                <p>Connect, share ideas, and collaborate with fellow members</p>
                <button class="btn" onclick="openModal('forum')">Access Forum</button>
                <div style="margin-top: 10px; font-size: 0.9rem;">
                    Discussions ‚Ä¢ Job Sharing ‚Ä¢ Training Materials<br>
                    Voice Calls ‚Ä¢ Messaging ‚Ä¢ Networking
                </div>
            </div>
        </div>

        <!-- Kabiru Mining Section -->
        <div class="kabiru-section">
            <h2>‚ö° KABIRU MINING</h2>
            <p>Mine Kabiru coins by proving and validating real values</p>
            <button class="btn-kabiru" onclick="window.open('https://magero1985.github.io/Kabiru-Mining-Portal-/', '_blank')">Access Kabiru Mining App</button>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Floating Member Access Button -->
    <div class="floating-btn" onclick="showMemberLogin()" title="Member Access">üë§</div>

    <!-- AI Assistant -->
    <div class="ai-assistant" onclick="toggleAIChat()" title="AI Assistant - Get Help">ü§ñ</div>

    <!-- AI Chat Window -->
    <div class="ai-chat-window" id="aiChatWindow">
        <div class="ai-chat-header">
            <span>TAU AI Assistant</span>
            <span onclick="toggleAIChat()" style="cursor: pointer;">‚úñ</span>
        </div>
        <div class="ai-chat-messages" id="aiChatMessages">
            <div class="ai-message">
                Hello! I'm your TAU Africa AI assistant. I can help you with:
                <br>‚Ä¢ Navigating the app
                <br>‚Ä¢ Understanding registration process
                <br>‚Ä¢ Payment procedures
                <br>‚Ä¢ Technical support
                <br>‚Ä¢ General questions about TAU Africa
                <br><br>How can I assist you today?
            </div>
        </div>
        <div class="ai-chat-input">
            <input type="text" id="aiChatInput" placeholder="Ask me anything..." onkeypress="handleAIChatKeyPress(event)">
            <button onclick="sendAIMessage()">‚û§</button>
        </div>
    </div>

<script>
// Initialize EmailJS with iOS compatibility
(function() {
    try {
        emailjs.init({
            publicKey: "GhjI14eQVGgOli0j1",
        });
        console.log('‚úÖ EmailJS initialized successfully');
    } catch (error) {
        console.error('‚ùå EmailJS initialization failed:', error);
        alert('Email system initialization failed. Please refresh the page.');
    }
})();

// Global variables
let currentModal = null;
let selectedLevel = '';
let selectedCategory = '';

// ===== FIXED EMAIL SENDING FUNCTION 
function sendEmailToOrganization(formData, subject) {
    const templateParams = {
        to_email: formData.email,
        to_name: formData.fullName || formData.name,
        subject: subject,
        message: `Welcome to TAU Africa!

Member ID: ${formData.memberId || 'TBD'}
Team: ${formData.team}
Email: ${formData.email}

Your account has been created successfully!`,
        from_name: 'TAU Africa Foundation',
        from_email: 'grouptauafrica@gmail.com',
        phone: formData.phone,
        location: formData.location
    };
    
    return emailjs.send('service_xfira7g', 'template_bqxztig', templateParams)
        .then(() => true)
        .catch(function(error) {
            console.error('‚ùå FAILED! Email error:', error);
            return false;
        });
}
// ===== M-PESA PAYMENT INTEGRATION =====
function initiateMpesaPayment(amount, phoneNumber, formData, successCallback) {
    showPaymentModal(amount, phoneNumber, formData, successCallback);
}

function showPaymentModal(amount, phoneNumber, formData, successCallback) {
    const paymentModal = document.createElement('div');
    paymentModal.className = 'payment-modal';
    paymentModal.innerHTML = `
        <div class="payment-widget">
            <h3>üì± M-PESA Payment</h3>
            <div class="payment-step">
                <h4>Amount: KSH ${amount}</h4>
                <p>Phone: ${phoneNumber}</p>
                <p style="color: #666; font-size: 0.9em;">A payment prompt will be sent to your phone</p>
            </div>
            <div id="paymentSteps">
                <div style="margin: 20px 0; padding: 15px; background: #f0f8ff; border-radius: 10px;">
                    <p><strong>Payment Process:</strong></p>
                    <ol style="text-align: left; margin-top: 10px;">
                        <li>Check your phone for M-PESA prompt</li>
                        <li>Enter your M-PESA PIN</li>
                        <li>Confirm the payment</li>
                        <li>Wait for confirmation</li>
                    </ol>
                </div>
                <input type="text" class="payment-input" placeholder="Enter confirmation code (if received)" id="confirmationCode">
                <button class="btn" onclick="simulatePayment(${amount}, '${phoneNumber}')">Confirm Payment</button>
            </div>
            <button class="btn" style="background: #e74c3c; margin-top: 20px;" onclick="cancelPayment()">Cancel Payment</button>
        </div>
    `;
    paymentModal.formData = formData;
    paymentModal.successCallback = successCallback;
    document.body.appendChild(paymentModal);
}

function simulatePayment(amount, phoneNumber) {
    const paymentModal = document.querySelector('.payment-modal');
    const confirmationCode = document.getElementById('confirmationCode').value;
    
    if (confirmationCode.length < 4) {
        showNotification('Please enter a valid confirmation code', 'error');
        return;
    }

    paymentModal.innerHTML = `
        <div class="payment-widget">
            <h3>Processing Payment...</h3>
            <div class="spinner"></div>
            <p>Verifying M-PESA transaction</p>
            <p style="font-size: 0.9em; color: #666;">Transaction ID: MPX${Date.now()}</p>
        </div>
    `;

    setTimeout(() => {
        if (Math.random() > 0.05) {
            const storedFormData = paymentModal.formData;
            const callback = paymentModal.successCallback;
            
            paymentModal.remove();
            
            if (callback === 'processTaskSuccess') {
                processTaskSuccess(storedFormData);
            } else if (callback === 'processTalkSuccess') {
                processTalkSuccess(storedFormData);
            } else if (callback === 'processJobCreationSuccess') {
                processJobCreationSuccess(storedFormData);
            }
            
            showNotification(`M-PESA payment of KSH ${amount} successful! Transaction ID: MPX${Date.now()}`, 'success');
        } else {
            paymentModal.remove();
            showNotification('Payment failed. Please try again or contact support.', 'error');
        }
    }, 3000);
}

function cancelPayment() {
    document.querySelector('.payment-modal')?.remove();
    showNotification('Payment cancelled', 'error');
}

// ===== NOTIFICATION SYSTEM =====
function showNotification(message, type = 'success') {
    const notification = document.getElementById('notification');
    notification.innerHTML = message;
    notification.className = `notification ${type}`;
    notification.style.display = 'block';
    
    setTimeout(() => {
        notification.style.display = 'none';
    }, 6000);
}

// ===== MODAL MANAGEMENT =====
function openModal(type) {
    closeAllModals();
    
    const modalContent = getModalContent(type);
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = modalContent;
    document.body.appendChild(modal);
    currentModal = modal;
}

function closeAllModals() {
    const modals = document.querySelectorAll('.modal, .payment-modal');
    modals.forEach(modal => modal.remove());
    currentModal = null;
}

// ===== SELECTION FUNCTIONS =====
function selectLevel(level, element) {
    const buttons = document.querySelectorAll('.level-btn');
    buttons.forEach(btn => btn.classList.remove('selected'));
    const target = element || (window.event && window.event.target);
    if (target) {
        target.classList.add('selected');
    }
    selectedLevel = level;
    const levelInput = document.getElementById('supportLevel');
    if (levelInput) levelInput.value = level;
    
    const enhanced = document.getElementById('enhancedRequirements');
    if (enhanced && (level === 'middle' || level === 'upper' || level === 'high' || level === 'top')) {
        enhanced.style.display = 'block';
    }
}

function selectCategory(category, element) {
    const buttons = document.querySelectorAll('.level-btn');
    buttons.forEach(btn => btn.classList.remove('selected'));
    const target = element || (window.event && window.event.target);
    if (target) {
        target.classList.add('selected');
    }
    selectedCategory = category;
    const categoryInput = document.getElementById('taskCategory');
    if (categoryInput) categoryInput.value = category;
}

// ===== FORM SUBMISSION HANDLERS =====
function processTaskRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    if (!data.phone || !data.fullName || !data.email || !selectedCategory) {
        showNotification('Please fill all required fields and select a category', 'error');
        return;
    }
    
    if (!data.phone.match(/^254[0-9]{9}$/)) {
        showNotification('Please use correct phone format: 254XXXXXXXXX', 'error');
        return;
    }
    
    data.category = selectedCategory;
    initiateMpesaPayment(500, data.phone, data, 'processTaskSuccess');
}

function processTalkRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    if (!data.phone || !data.fullName || !data.email || !selectedLevel) {
        showNotification('Please fill all required fields and select a support level', 'error');
        return;
    }
    
    if (!data.phone.match(/^254[0-9]{9}$/)) {
        showNotification('Please use correct phone format: 254XXXXXXXXX', 'error');
        return;
    }
    
    data.supportLevel = selectedLevel;
    initiateMpesaPayment(2000, data.phone, data, 'processTalkSuccess');
}

function processJobCreationTraining(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    if (!data.phone || !data.fullName || !data.email) {
        showNotification('Please fill all required fields', 'error');
        return;
    }
    
    if (!data.phone.match(/^254[0-9]{9}$/)) {
        showNotification('Please use correct phone format: 254XXXXXXXXX', 'error');
        return;
    }
    
    initiateMpesaPayment(1500, data.phone, data, 'processJobCreationSuccess');
}

// ===== SUCCESS HANDLERS WITH FIXED EMAIL =====
function processTaskSuccess(formData) {
    console.log('Processing TASK success with email...');
    sendEmailToOrganization(formData, 'NEW TASK TEAM REGISTRATION - PAYMENT CONFIRMED')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Registration complete! Welcome to TASK team. Confirmation email sent to grouptauafrica@gmail.com', 'success');
                closeAllModals();
            } else {
                showNotification('‚ö†Ô∏è Registration saved but email notification failed. Our team will contact you.', 'error');
            }
        });
}

function processTalkSuccess(formData) {
    console.log('Processing TALK success with email...');
    sendEmailToOrganization(formData, 'NEW TALK TEAM REGISTRATION - PAYMENT CONFIRMED')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Registration complete! Welcome to TALK team. Confirmation email sent to grouptauafrica@gmail.com', 'success');
                closeAllModals();
            } else {
                showNotification('‚ö†Ô∏è Registration saved but email notification failed. Our team will contact you.', 'error');
            }
        });
}

function processJobCreationSuccess(formData) {
    console.log('Processing Job Creation success with email...');
    sendEmailToOrganization(formData, 'JOB CREATION TRAINING ENROLLMENT - PAYMENT CONFIRMED')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Training enrollment complete! Confirmation email sent to grouptauafrica@gmail.com', 'success');
                closeAllModals();
            } else {
                showNotification('‚ö†Ô∏è Enrollment saved but email notification failed. Our team will contact you.', 'error');
            }
        });
}

// ===== OTHER FORM SUBMISSIONS WITH FIXED EMAIL =====
function processTrainingRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting training registration...');
    sendEmailToOrganization(data, 'TRAINING PROGRAM REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Training registration successful! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processWorkshopProposal(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting workshop proposal...');
    sendEmailToOrganization(data, 'WORKSHOP PROPOSAL SUBMISSION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Workshop proposal submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processResearchRequest(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting research request...');
    sendEmailToOrganization(data, 'RESEARCH SERVICES REQUEST')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Research request submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processJobPosting(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting job posting...');
    sendEmailToOrganization(data, 'NEW JOB POSTING')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Job posting submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processJobSearch(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting job search...');
    sendEmailToOrganization(data, 'JOB SEARCH REQUEST')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Job search submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processJobApplication(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting job application...');
    sendEmailToOrganization(data, 'JOB APPLICATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Application submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processCommunityRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting community registration...');
    sendEmailToOrganization(data, 'COMMUNITY PROGRAM REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Community registration successful! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processCorporateRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting corporate registration...');
    sendEmailToOrganization(data, 'CORPORATE REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Corporate registration submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processParSiraiRegistration(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Par Sirai registration...');
    sendEmailToOrganization(data, 'PAR SIRAI CENTER REGISTRATION')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Par Sirai registration successful! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processTrustGraphAccess(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Trust Graph access...');
    sendEmailToOrganization(data, 'TRUST GRAPH ACCESS REQUEST')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Trust Graph access requested! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processFoundationInquiry(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Foundation inquiry...');
    sendEmailToOrganization(data, 'FOUNDATION INQUIRY')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Foundation inquiry submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

function processHoldingsInquiry(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    
    console.log('Submitting Holdings inquiry...');
    sendEmailToOrganization(data, 'COMPANY HOLDINGS INQUIRY')
        .then(success => {
            if (success) {
                showNotification('‚úÖ Holdings inquiry submitted! Email sent.', 'success');
                closeAllModals();
            } else {
                showNotification('‚ùå Email failed. Please contact grouptauafrica@gmail.com', 'error');
            }
        });
}

// ===== AI ASSISTANT FUNCTIONS =====
function toggleAIChat() {
    const chatWindow = document.getElementById('aiChatWindow');
    if (chatWindow.style.display === 'none' || !chatWindow.style.display) {
        chatWindow.style.display = 'flex';
    } else {
        chatWindow.style.display = 'none';
    }
}

function handleAIChatKeyPress(event) {
    if (event.key === 'Enter') {
        sendAIMessage();
    }
}

function sendAIMessage() {
    const input = document.getElementById('aiChatInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    const messagesContainer = document.getElementById('aiChatMessages');
    
    const userMessage = document.createElement('div');
    userMessage.className = 'ai-message user-message';
    userMessage.textContent = message;
    messagesContainer.appendChild(userMessage);
    
    input.value = '';
    
    setTimeout(() => {
        const aiResponse = generateAIResponse(message);
        const aiMessage = document.createElement('div');
        aiMessage.className = 'ai-message';
        aiMessage.innerHTML = aiResponse;
        messagesContainer.appendChild(aiMessage);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }, 1000);
    
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function generateAIResponse(userMessage) {
    const message = userMessage.toLowerCase();
    
    if (message.includes('register') || message.includes('join')) {
        return `To register with TAU Africa, you can choose between:<br>
        ‚Ä¢ <strong>TASK Team (KSH 500)</strong> - For service providers and skilled professionals<br>
        ‚Ä¢ <strong>TALK Team (KSH 2,000)</strong> - For investors and financial supporters<br>
        ‚Ä¢ <strong>Job Creation Training (KSH 1,500)</strong> - For aspiring entrepreneurs<br>
        <br>Click the relevant buttons in the Membership section to get started!`;
    }
    
    if (message.includes('payment') || message.includes('mpesa')) {
        return `Our payment process uses M-PESA:<br>
        1. Enter your M-PESA number (254XXXXXXXXX format)<br>
        2. You'll receive a payment prompt on your phone<br>
        3. Enter your M-PESA PIN to confirm<br>
        4. Wait for confirmation<br>
        <br>All payments are secure and processed instantly!`;
    }
    
    if (message.includes('kabiru') || message.includes('mining')) {
        return `Kabiru is our digital currency! You can:<br>
        ‚Ä¢ Mine Kabiru by validating real values in the community<br>
        ‚Ä¢ Use the mining portal<br>
        ‚Ä¢ Earn through community contributions<br>
        ‚Ä¢ Convert to other currencies through our ecosystem`;
    }
    
    if (message.includes('help') || message.includes('support')) {
        return `I'm here to help! You can ask me about:<br>
        ‚Ä¢ Registration processes and payments<br>
        ‚Ä¢ Kabiru mining and digital currency<br>
        ‚Ä¢ Community programs and training<br>
        ‚Ä¢ Technical issues with the app<br>
        ‚Ä¢ Business registration services<br>
        <br>What specific area would you like help with?`;
    }
    
    return `Thank you for your question! Here are some ways I can help:<br>
    ‚Ä¢ Registration and membership information<br>
    ‚Ä¢ Payment and M-PESA guidance<br>
    ‚Ä¢ Kabiru mining and digital currency<br>
    ‚Ä¢ Community programs and forum access<br>
    ‚Ä¢ Technical support<br>
    <br>Please ask a specific question, or contact <strong>grouptauafrica@gmail.com</strong> for detailed support.`;
}

// ===== MEMBER LOGIN FUNCTIONS =====
function showMemberLogin() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>Member Login</h2>
            <p>Access your TAU Africa member dashboard</p>
            
            <form onsubmit="simulateLogin(event)">
                <div class="form-group">
                    <label>Email or Member ID</label>
                    <input type="text" name="loginId" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" name="password" required>
                </div>
                <button type="submit" class="btn">Login to Dashboard</button>
                
                <div style="text-align: center; margin-top: 20px;">
                    <p>New member? Complete registration through TASK or TALK teams first!</p>
                </div>
            </form>
            
            <div style="background: #f0f8ff; padding: 15px; border-radius: 10px; margin-top: 20px;">
                <h4>Demo Access:</h4>
                <p>Use any email/password to see dashboard preview</p>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

function simulateLogin(event) {
    event.preventDefault();
    showNotification('Login successful! Loading dashboard...', 'success');
    setTimeout(() => {
        closeAllModals();
        showMemberDashboard();
    }, 1500);
}

function showMemberDashboard() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    modal.innerHTML = `
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>TAU Africa Member Dashboard</h2>
            <p>Welcome, <strong>Demo User</strong></p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0;">
                <div style="background: linear-gradient(45deg, #4169e1, #87ceeb); color: white; padding: 20px; border-radius: 15px; text-align: center; cursor: pointer;" onclick="showNotification('Profile management launching soon!', 'success')">
                    <h4>My Profile</h4>
                    <p>Manage account</p>
                </div>
                <div style="background: linear-gradient(45deg, #ff6b6b, #ee5a24); color: white; padding: 20px; border-radius: 15px; text-align: center; cursor: pointer;" onclick="showNotification('Programs dashboard launching soon!', 'success')">
                    <h4>My Programs</h4>
                    <p>Active memberships</p>
                </div>
                <div style="background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; padding: 20px; border-radius: 15px; text-align: center; cursor: pointer;" onclick="window.open('https://magero1985.github.io/Kabiru-Mining-Portal-/', '_blank')">
                    <h4>Kabiru Wallet</h4>
                    <p>0.00 KABIRU<br><small>Click to mine</small></p>
                </div>
                <div style="background: linear-gradient(45deg, #9b59b6, #8e44ad); color: white; padding: 20px; border-radius: 15px; text-align: center; cursor: pointer;" onclick="openModal('forum')">
                    <h4>Community</h4>
                    <p>Forum & networking</p>
                </div>
            </div>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin: 20px 0;">
                <h3>Recent Activity</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="padding: 10px 0; border-bottom: 1px solid #eee;">Registration completed - Welcome to TAU Africa!</li>
                    <li style="padding: 10px 0; border-bottom: 1px solid #eee;">Welcome email sent</li>
                    <li style="padding: 10px 0;">Ready to start your journey!</li>
                </ul>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <p><strong>Note:</strong> This is a dashboard preview. Full functionality available after registration.</p>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

// ===== EVENT LISTENERS =====
document.addEventListener('click', function(event) {
    if (event.target.classList.contains('modal')) {
        closeAllModals();
    }
});

document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeAllModals();
        document.getElementById('aiChatWindow').style.display = 'none';
    }
});

// ===== INITIALIZE APP =====
document.addEventListener('DOMContentLoaded', function() {
    console.log('========================================');
    console.log('TAU AFRICA INTERNATIONAL - INITIALIZED');
    console.log('========================================');
    console.log('‚úÖ EmailJS Status: ACTIVE & CONFIGURED');
    console.log('‚úÖ Service ID: service_xfira7g');
    console.log('‚úÖ Template ID: template_q2lu285');
    console.log('‚úÖ Recipient: grouptauafrica@gmail.com');
    console.log('‚úÖ M-PESA Payment: READY');
    console.log('‚úÖ All Forms: FUNCTIONAL WITH EMAIL');
    console.log('‚úÖ AI Assistant: ACTIVE');
    console.log('========================================');
    
    showNotification('‚úÖ Welcome to TAU Africa International! Email system is now ACTIVE - all forms will send to grouptauafrica@gmail.com', 'success');
});
        
// ===== GET MODAL CONTENT BASED ON TYPE =====
function getModalContent(type) {
    switch(type) {
        case 'taskRegistration':
            return createTaskRegistrationModal();
        case 'talkRegistration':
            return createTalkRegistrationModal();
        case 'corporate':
            return createCorporateModal();
        case 'training':
            return createTrainingModal();
        case 'workshop':
            return createWorkshopModal();
        case 'research':
            return createResearchModal();
        case 'jobCreation':
            return createJobCreationModal();
        case 'insertJob':
            return createInsertJobModal();
        case 'retrieveJob':
            return createRetrieveJobModal();
        case 'availableJobs':
            return createAvailableJobsModal();
        case 'applyJob':
            return createApplyJobModal();
        case 'community':
            return createCommunityModal();
        case 'parSirai':
            return createParSiraiModal();
        case 'trustGraph':
            return createTrustGraphModal();
        case 'foundation':
            return createFoundationModal();
        case 'holdings':
            return createHoldingsModal();
        case 'forum':
            return createForumModal();
        default:
            return '<div class="modal-content"><span class="close" onclick="closeAllModals()">&times;</span><h2>Feature Coming Soon</h2><p>This feature is under development.</p></div>';
    }
}

// ===== COMPREHENSIVE TASK REGISTRATION MODAL =====
function createTaskRegistrationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>Join TASK Team</h2>
            <p>Declare the values or services you're offering to the TAU Africa community</p>
            
            <div class="payment-info">
                <h3>Registration Fee: KSH 500</h3>
                <p>Secure M-PESA payment required ‚Ä¢ One-time membership fee</p>
            </div>
            
            <form onsubmit="processTaskRegistration(event)" id="taskForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required placeholder="Enter your full legal name">
                </div>
                
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" name="email" required placeholder="your.email@example.com">
                </div>
                
                <div class="form-group">
                    <label>Phone Number (M-PESA) *</label>
                    <input type="tel" name="phone" required placeholder="254XXXXXXXXX" pattern="254[0-9]{9}">
                    <small>Format: 254XXXXXXXXX (include country code)</small>
                </div>
                
                <div class="form-group">
                    <label>Country/Location *</label>
                    <input type="text" name="location" required placeholder="City, Country">
                </div>

                <div class="form-group">
                    <label>Date of Birth *</label>
                    <input type="date" name="dateOfBirth" required>
                </div>

                <div class="form-group">
                    <label>Gender *</label>
                    <select name="gender" required>
                        <option value="">Select gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                        <option value="Prefer not to say">Prefer not to say</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Nationality *</label>
                    <input type="text" name="nationality" required placeholder="Your nationality">
                </div>
                
                <div class="form-group">
                    <label>Value Category *</label>
                    <div class="level-selection">
                        <div class="level-btn" onclick="selectCategory('skills', this)">Skills & Crafts</div>
                        <div class="level-btn" onclick="selectCategory('knowledge', this)">Knowledge & Expertise</div>
                        <div class="level-btn" onclick="selectCategory('service', this)">Professional Service</div>
                        <div class="level-btn" onclick="selectCategory('profession', this)">Licensed Profession</div>
                        <div class="level-btn" onclick="selectCategory('creativity', this)">Creative Arts</div>
                        <div class="level-btn" onclick="selectCategory('leadership', this)">Leadership & Management</div>
                        <div class="level-btn" onclick="selectCategory('business', this)">Business & Entrepreneurship</div>
                    </div>
                    <input type="hidden" name="category" id="taskCategory" required>
                </div>
                
                <div class="form-group">
                    <label>Describe Your Value/Service *</label>
                    <textarea name="valueDescription" rows="4" placeholder="Provide a detailed description of what you offer, your expertise, and how it benefits the community" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="experience" required>
                        <option value="">Select level</option>
                        <option value="Beginner">Beginner (0-2 years)</option>
                        <option value="Intermediate">Intermediate (2-5 years)</option>
                        <option value="Advanced">Advanced (5-10 years)</option>
                        <option value="Expert">Expert (10+ years)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Professional Certifications/Licenses</label>
                    <textarea name="certifications" rows="2" placeholder="List any professional certifications, licenses, or credentials you hold"></textarea>
                </div>

                <div class="form-group">
                    <label>Languages Spoken *</label>
                    <input type="text" name="languages" required placeholder="e.g., English, Swahili, French">
                </div>
                
                <h3 style="color: #2a5298; margin: 25px 0 15px 0;">Proof of Innocence & Capabilities</h3>
                
                <div class="form-group">
                    <label>Certificate of Good Conduct Status *</label>
                    <select name="goodConduct" required>
                        <option value="">Select status</option>
                        <option value="Available">Available - Can provide immediately</option>
                        <option value="Will obtain">Will obtain upon request</option>
                        <option value="In process">Currently in process of obtaining</option>
                        <option value="Not applicable">Not applicable in my country</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Health Records Status *</label>
                    <select name="healthStatus" required>
                        <option value="">Select status</option>
                        <option value="Excellent">Excellent health - Can provide medical certificate</option>
                        <option value="Good">Good health - Regular checkups</option>
                        <option value="Will provide">Will provide upon request</option>
                        <option value="Private">Prefer to keep private</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Track Record/References</label>
                    <textarea name="trackRecord" rows="3" placeholder="Previous work experience, achievements, client testimonials, or references (include contact information if possible)"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Family/Support System</label>
                    <textarea name="familySupport" rows="2" placeholder="Brief description of your family situation and support system"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Educational Qualifications</label>
                    <textarea name="education" rows="2" placeholder="Degrees, certificates, training completed, institutions attended"></textarea>
                </div>

                <div class="form-group">
                    <label>Emergency Contact *</label>
                    <input type="text" name="emergencyContact" required placeholder="Name and phone number">
                </div>

                <div class="form-group">
                    <label>How did you hear about TAU Africa? *</label>
                    <select name="referralSource" required>
                        <option value="">Select source</option>
                        <option value="Social Media">Social Media (Twitter/X, TikTok, YouTube)</option>
                        <option value="Friend/Family">Friend or Family Member</option>
                        <option value="Community Event">Community Event</option>
                        <option value="Online Search">Online Search</option>
                        <option value="Business Network">Business Network</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" name="terms" required style="width: auto; margin-right: 10px;">
                        I agree to the TAU Africa Terms of Service and Privacy Policy *
                    </label>
                </div>
                
                <button type="submit" class="btn btn-register">Proceed to M-PESA Payment (KSH 500)</button>
            </form>
        </div>
    `;
}

// ===== COMPREHENSIVE TALK REGISTRATION MODAL =====
function createTalkRegistrationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>Join TALK Team</h2>
            <p>Declare financial support, grants, or investments you're offering to the African development ecosystem</p>
            
            <div class="payment-info">
                <h3>Registration Fee: KSH 2,000</h3>
                <p>Secure M-PESA payment ‚Ä¢ Deposit goes to Valenta Liquid Pool Reserve for Kabiru value conversion</p>
            </div>
            
            <form onsubmit="processTalkRegistration(event)" id="talkForm">
                <div class="form-group">
                    <label>Full Name/Organization Name *</label>
                    <input type="text" name="fullName" required placeholder="Individual name or organization">
                </div>
                
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" name="email" required placeholder="your.email@example.com">
                </div>
                
                <div class="form-group">
                    <label>Phone Number (M-PESA) *</label>
                    <input type="tel" name="phone" required placeholder="254XXXXXXXXX" pattern="254[0-9]{9}">
                </div>
                
                <div class="form-group">
                    <label>Country/Location *</label>
                    <input type="text" name="location" required>
                </div>

                <div class="form-group">
                    <label>Organization Type *</label>
                    <select name="organizationType" required>
                        <option value="">Select type</option>
                        <option value="Individual Investor">Individual Investor</option>
                        <option value="Corporation">Corporation</option>
                        <option value="Foundation">Foundation/NGO</option>
                        <option value="Government Agency">Government Agency</option>
                        <option value="Investment Fund">Investment Fund</option>
                        <option value="Development Bank">Development Bank</option>
                        <option value="Family Office">Family Office</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Website/LinkedIn Profile</label>
                    <input type="url" name="website" placeholder="https://example.com">
                </div>
                
                <div class="form-group">
                    <label>Financial Support Level *</label>
                    <div class="level-selection">
                        <div class="level-btn" onclick="selectLevel('ground', this)">Ground Level (&lt; $1,000)</div>
                        <div class="level-btn" onclick="selectLevel('middle', this)">Middle Level ($1,000-$5,000)</div>
                        <div class="level-btn" onclick="selectLevel('upper', this)">Upper Level ($5,000-$10,000)</div>
                        <div class="level-btn" onclick="selectLevel('high', this)">High Level ($10,000-$50,000)</div>
                        <div class="level-btn" onclick="selectLevel('top', this)">Top Level ($50,000+)</div>
                    </div>
                    <input type="hidden" name="supportLevel" id="supportLevel" required>
                </div>
                
                <div class="form-group">
                    <label>Type of Financial Support *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <label><input type="checkbox" name="supportTypes" value="Grants"> Grants</label>
                        <label><input type="checkbox" name="supportTypes" value="Equity Investment"> Equity Investment</label>
                        <label><input type="checkbox" name="supportTypes" value="Debt Financing"> Debt Financing</label>
                        <label><input type="checkbox" name="supportTypes" value="Venture Capital"> Venture Capital</label>
                        <label><input type="checkbox" name="supportTypes" value="Angel Investment"> Angel Investment</label>
                        <label><input type="checkbox" name="supportTypes" value="Crowdfunding"> Crowdfunding</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Focus Areas/Industries *</label>
                    <textarea name="focusAreas" rows="3" placeholder="What sectors, industries, or types of projects do you want to support? (e.g., Agriculture, Technology, Education, Healthcare)" required></textarea>
                </div>

                <div class="form-group">
                    <label>Geographic Focus</label>
                    <input type="text" name="geographicFocus" placeholder="Specific countries or regions of interest">
                </div>

                <div class="form-group">
                    <label>Investment Criteria</label>
                    <textarea name="investmentCriteria" rows="3" placeholder="What criteria do you use when evaluating investment opportunities?"></textarea>
                </div>

                <div class="form-group">
                    <label>Previous African Investments</label>
                    <textarea name="previousInvestments" rows="2" placeholder="Brief description of previous investments or support in Africa"></textarea>
                </div>
                
                <div id="enhancedRequirements" style="display: none;">
                    <h3 style="color: #2a5298; margin: 25px 0 15px 0;">Enhanced Requirements (Middle Level & Above)</h3>
                    
                    <div class="form-group">
                        <label>Certificate of Good Conduct *</label>
                        <select name="goodConduct">
                            <option value="">Select status</option>
                            <option value="Available">Available - Can provide</option>
                            <option value="Will obtain">Will obtain upon request</option>
                            <option value="Not applicable">Not applicable in my country</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Health Records Status *</label>
                        <select name="healthStatus">
                            <option value="">Select status</option>
                            <option value="Excellent">Excellent health - Can provide certificate</option>
                            <option value="Good">Good health - Regular checkups</option>
                            <option value="Will provide">Will provide upon request</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Financial Track Record *</label>
                        <textarea name="financialTrack" rows="3" placeholder="Previous investments, business ventures, financial background, investment performance"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Net Worth Range (Optional)</label>
                        <select name="netWorth">
                            <option value="">Prefer not to disclose</option>
                            <option value="Under $100K">Under $100,000</option>
                            <option value="$100K-$500K">$100,000 - $500,000</option>
                            <option value="$500K-$1M">$500,000 - $1,000,000</option>
                            <option value="$1M-$5M">$1,000,000 - $5,000,000</option>
                            <option value="$5M-$10M">$5,000,000 - $10,000,000</option>
                            <option value="Over $10M">Over $10,000,000</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Family/Organizational Financial Support</label>
                        <textarea name="familyFinancial" rows="2" placeholder="Family financial situation or organizational financial backing"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" name="terms" required style="width: auto; margin-right: 10px;">
                        I agree to the TAU Africa Terms of Service and Privacy Policy *
                    </label>
                </div>
                
                <button type="submit" class="btn btn-register">Proceed to M-PESA Payment (KSH 2,000)</button>
            </form>
        </div>
    `;
}

// ===== JOB CREATION TRAINING MODAL - COMPREHENSIVE =====
function createJobCreationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üíº Job Creation Training Program</h2>
            <p>Comprehensive entrepreneurship and job creation program designed for African innovators</p>
            
            <div class="payment-info">
                <h3>Training Fee: KSH 1,500</h3>
                <p>6-week intensive program ‚Ä¢ Digital materials ‚Ä¢ Certification ‚Ä¢ Mentorship support</p>
            </div>
            
            <form onsubmit="processJobCreationTraining(event)" id="jobCreationForm">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number (M-PESA) *</label>
                    <input type="tel" name="phone" required placeholder="254XXXXXXXXX">
                </div>
                
                <div class="form-group">
                    <label>Location *</label>
                    <input type="text" name="location" required>
                </div>

                <div class="form-group">
                    <label>Age Range *</label>
                    <select name="ageRange" required>
                        <option value="">Select age range</option>
                        <option value="18-25">18-25 years</option>
                        <option value="26-35">26-35 years</option>
                        <option value="36-45">36-45 years</option>
                        <option value="46-55">46-55 years</option>
                        <option value="56+">56+ years</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Current Employment Status *</label>
                    <select name="employmentStatus" required>
                        <option value="">Select status</option>
                        <option value="Unemployed">Unemployed</option>
                        <option value="Underemployed">Underemployed</option>
                        <option value="Student">Student</option>
                        <option value="Self-employed">Self-employed</option>
                        <option value="Employed">Employed (seeking additional income)</option>
                        <option value="Recent Graduate">Recent Graduate</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Business Idea/Interest Area *</label>
                    <textarea name="businessIdea" rows="3" placeholder="What type of business or job creation are you interested in? Be specific about your vision." required></textarea>
                </div>

                <div class="form-group">
                    <label>Target Market/Customers *</label>
                    <textarea name="targetMarket" rows="2" placeholder="Who will be your customers or beneficiaries?" required></textarea>
                </div>

                <div class="form-group">
                    <label>Available Capital/Startup Funds</label>
                    <select name="startupFunds">
                        <option value="">Select range</option>
                        <option value="No funds">No funds available</option>
                        <option value="Under KSH 10K">Under KSH 10,000</option>
                        <option value="KSH 10K-50K">KSH 10,000 - 50,000</option>
                        <option value="KSH 50K-100K">KSH 50,000 - 100,000</option>
                        <option value="KSH 100K-500K">KSH 100,000 - 500,000</option>
                        <option value="Over KSH 500K">Over KSH 500,000</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Educational Background *</label>
                    <select name="education" required>
                        <option value="">Select level</option>
                        <option value="Primary School">Primary School</option>
                        <option value="Secondary School">Secondary School</option>
                        <option value="College Diploma">College Diploma</option>
                        <option value="University Degree">University Degree</option>
                        <option value="Postgraduate">Postgraduate</option>
                        <option value="Vocational Training">Vocational Training</option>
                        <option value="Self-taught">Self-taught</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Relevant Skills/Experience</label>
                    <textarea name="relevantSkills" rows="2" placeholder="List any skills or experience relevant to your business idea"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Training Focus Areas (Select all that apply) *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                        <label><input type="checkbox" name="focus" value="Business Planning"> Business Planning</label>
                        <label><input type="checkbox" name="focus" value="Financial Management"> Financial Management</label>
                        <label><input type="checkbox" name="focus" value="Marketing & Sales"> Marketing & Sales</label>
                        <label><input type="checkbox" name="focus" value="Digital Skills"> Digital Skills</label>
                        <label><input type="checkbox" name="focus" value="Leadership"> Leadership</label>
                        <label><input type="checkbox" name="focus" value="Networking"> Networking</label>
                        <label><input type="checkbox" name="focus" value="Legal Compliance"> Legal Compliance</label>
                        <label><input type="checkbox" name="focus" value="Product Development"> Product Development</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Preferred Learning Format *</label>
                    <select name="learningFormat" required>
                        <option value="">Select format</option>
                        <option value="Online only">Online only</option>
                        <option value="In-person only">In-person only</option>
                        <option value="Hybrid">Hybrid (Online + In-person)</option>
                        <option value="Self-paced">Self-paced online</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Timeline to Start Business *</label>
                    <select name="businessTimeline" required>
                        <option value="">Select timeline</option>
                        <option value="Within 3 months">Within 3 months</option>
                        <option value="3-6 months">3-6 months</option>
                        <option value="6-12 months">6-12 months</option>
                        <option value="Over 1 year">Over 1 year</option>
                        <option value="Just exploring">Just exploring options</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" name="terms" required style="width: auto; margin-right: 10px;">
                        I agree to the TAU Africa Terms of Service and Privacy Policy *
                    </label>
                </div>
                
                <button type="submit" class="btn btn-register">Proceed to M-PESA Payment (KSH 1,500)</button>
            </form>
        </div>
    `;
}
        // TAU AFRICA INTERNATIONAL - PART 4: REMAINING MODALS 

// ===== TRAINING MODAL =====
function createTrainingModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìö Join Training Programs</h2>
            
            <form onsubmit="processTrainingRegistration(event)">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Training Category *</label>
                    <select name="trainingCategory" required>
                        <option value="">Select training area</option>
                        <option>Digital Skills & Technology</option>
                        <option>Business & Entrepreneurship</option>
                        <option>Financial Literacy</option>
                        <option>Leadership Development</option>
                        <option>Agricultural Innovation</option>
                        <option>Pan-African Studies</option>
                        <option>Health & Wellness</option>
                        <option>Creative Arts</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="level" required>
                        <option value="">Select level</option>
                        <option>Beginner</option>
                        <option>Intermediate</option>
                        <option>Advanced</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Learning Goals *</label>
                    <textarea name="goals" rows="3" placeholder="What do you hope to achieve through this training?" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Preferred Training Format</label>
                    <select name="format">
                        <option>Online</option>
                        <option>In-person</option>
                        <option>Hybrid</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Register for Training</button>
            </form>
        </div>
    `;
}

// ===== WORKSHOP MODAL =====
function createWorkshopModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üéØ Host a Workshop</h2>
            
            <form onsubmit="processWorkshopProposal(event)">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="hostName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Workshop Title *</label>
                    <input type="text" name="workshopTitle" required>
                </div>
                
                <div class="form-group">
                    <label>Workshop Category *</label>
                    <select name="category" required>
                        <option value="">Select category</option>
                        <option>Business & Entrepreneurship</option>
                        <option>Technology & Innovation</option>
                        <option>Arts & Culture</option>
                        <option>Health & Wellness</option>
                        <option>Education & Skills</option>
                        <option>Pan-African Studies</option>
                        <option>Financial Literacy</option>
                        <option>Agriculture & Food Security</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Workshop Description *</label>
                    <textarea name="description" rows="4" placeholder="Detailed description of workshop content and objectives" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Target Audience *</label>
                    <textarea name="audience" rows="2" placeholder="Who should attend this workshop?" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Duration *</label>
                    <select name="duration" required>
                        <option value="">Select duration</option>
                        <option>2 hours</option>
                        <option>Half day (4 hours)</option>
                        <option>Full day (8 hours)</option>
                        <option>2 days</option>
                        <option>3-5 days</option>
                        <option>1 week</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Your Expertise/Qualifications *</label>
                    <textarea name="expertise" rows="3" placeholder="Your background and qualifications for hosting this workshop" required></textarea>
                </div>
                
                <button type="submit" class="btn">Submit Workshop Proposal</button>
            </form>
        </div>
    `;
}

// ===== RESEARCH SERVICES MODAL =====
function createResearchModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üî¨ Research Services</h2>
            
            <form onsubmit="processResearchRequest(event)">
                <div class="form-group">
                    <label>Organization/Individual Name *</label>
                    <input type="text" name="clientName" required>
                </div>
                
                <div class="form-group">
                    <label>Contact Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Research Type *</label>
                    <select name="researchType" required>
                        <option value="">Select research type</option>
                        <option>Market Research</option>
                        <option>Academic Research</option>
                        <option>Policy Research</option>
                        <option>Social Impact Assessment</option>
                        <option>Business Intelligence</option>
                        <option>Pan-African Studies</option>
                        <option>Economic Analysis</option>
                        <option>Cultural Research</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Research Topic/Subject *</label>
                    <input type="text" name="topic" placeholder="Brief description of research topic" required>
                </div>
                
                <div class="form-group">
                    <label>Detailed Research Requirements *</label>
                    <textarea name="requirements" rows="4" placeholder="Specific research questions, methodology preferences, deliverables expected" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Timeline *</label>
                    <select name="timeline" required>
                        <option value="">Select timeline</option>
                        <option>1-2 weeks</option>
                        <option>1 month</option>
                        <option>2-3 months</option>
                        <option>3-6 months</option>
                        <option>6+ months</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Budget Range (USD)</label>
                    <select name="budget">
                        <option value="">Select budget range</option>
                        <option>Under $1,000</option>
                        <option>$1,000 - $5,000</option>
                        <option>$5,000 - $10,000</option>
                        <option>$10,000 - $25,000</option>
                        <option>$25,000+</option>
                        <option>To be discussed</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Submit Research Request</button>
            </form>
        </div>
    `;
}

// ===== INSERT JOB MODAL =====
function createInsertJobModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìù Post a Job Opening</h2>
            
            <form onsubmit="processJobPosting(event)">
                <div class="form-group">
                    <label>Company/Organization Name *</label>
                    <input type="text" name="companyName" required>
                </div>
                
                <div class="form-group">
                    <label>Contact Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Contact Phone *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Job Title *</label>
                    <input type="text" name="jobTitle" required>
                </div>
                
                <div class="form-group">
                    <label>Job Category *</label>
                    <select name="jobCategory" required>
                        <option value="">Select category</option>
                        <option>IT & Digital Economy</option>
                        <option>Marketing & Advertisements</option>
                        <option>Front Desk & Data Handlers</option>
                        <option>Management</option>
                        <option>Healthcare</option>
                        <option>Sales & Customer Service</option>
                        <option>Education & Training</option>
                        <option>Engineering</option>
                        <option>Finance & Accounting</option>
                        <option>Agriculture & Food</option>
                        <option>Manufacturing</option>
                        <option>Transportation & Logistics</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Job Type *</label>
                    <select name="jobType" required>
                        <option value="">Select type</option>
                        <option>Full-time</option>
                        <option>Part-time</option>
                        <option>Contract</option>
                        <option>Freelance</option>
                        <option>Internship</option>
                        <option>Temporary</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Location *</label>
                    <input type="text" name="location" required>
                </div>
                
                <div class="form-group">
                    <label>Job Description *</label>
                    <textarea name="jobDescription" rows="4" placeholder="Detailed job description, responsibilities, requirements" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Required Qualifications *</label>
                    <textarea name="qualifications" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="experienceLevel" required>
                        <option value="">Select level</option>
                        <option>Entry Level (0-2 years)</option>
                        <option>Mid Level (2-5 years)</option>
                        <option>Senior Level (5-10 years)</option>
                        <option>Executive Level (10+ years)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Salary Range (Optional)</label>
                    <input type="text" name="salary" placeholder="e.g., KSH 50,000 - 80,000">
                </div>
                
                <button type="submit" class="btn">Post Job Opening</button>
            </form>
        </div>
    `;
}

// ===== JOB SEARCH MODAL =====
function createRetrieveJobModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üîç Job Search Portal</h2>
            
            <form onsubmit="processJobSearch(event)">
                <div class="form-group">
                    <label>Your Name *</label>
                    <input type="text" name="searcherName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Job Category</label>
                    <select name="category">
                        <option value="">All categories</option>
                        <option>IT & Digital Economy</option>
                        <option>Marketing & Advertisements</option>
                        <option>Front Desk & Data Handlers</option>
                        <option>Management</option>
                        <option>Healthcare</option>
                        <option>Sales & Customer Service</option>
                        <option>Education & Training</option>
                        <option>Engineering</option>
                        <option>Finance & Accounting</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Preferred Location</label>
                    <input type="text" name="location" placeholder="City, Country or Remote">
                </div>
                
                <div class="form-group">
                    <label>Experience Level</label>
                    <select name="experience">
                        <option value="">Any level</option>
                        <option>Entry Level</option>
                        <option>Mid Level</option>
                        <option>Senior Level</option>
                        <option>Executive Level</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Job Type</label>
                    <select name="jobType">
                        <option value="">Any type</option>
                        <option>Full-time</option>
                        <option>Part-time</option>
                        <option>Contract</option>
                        <option>Freelance</option>
                        <option>Internship</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Search Jobs</button>
            </form>
        </div>
    `;
}

// ===== AVAILABLE JOBS MODAL =====
function createAvailableJobsModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìã Available Jobs</h2>
            <p>Browse current job opportunities</p>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>Sample Job Listings:</h3>
                <div style="border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px;">
                    <h4>Software Developer - Tech Startup</h4>
                    <p><strong>Location:</strong> Nairobi, Kenya</p>
                    <p><strong>Requirements:</strong> 2+ years experience, JavaScript, React</p>
                    <button class="btn" onclick="openModal('applyJob')">Apply Now</button>
                </div>
                <div style="border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px;">
                    <h4>Marketing Manager - NGO</h4>
                    <p><strong>Location:</strong> Lagos, Nigeria</p>
                    <p><strong>Requirements:</strong> Marketing degree, 3+ years experience</p>
                    <button class="btn" onclick="openModal('applyJob')">Apply Now</button>
                </div>
            </div>
            
            <div style="text-align: center;">
                <p>More jobs available to registered members</p>
                <button class="btn" onclick="openModal('taskRegistration')">Join TASK Team to Access All Jobs</button>
            </div>
        </div>
    `;
}

// ===== APPLY FOR JOB MODAL =====
function createApplyJobModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üìã Job Application</h2>
            
            <form onsubmit="processJobApplication(event)">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Location/Address *</label>
                    <input type="text" name="location" required>
                </div>
                
                <div class="form-group">
                    <label>Position Applying For *</label>
                    <input type="text" name="position" required>
                </div>
                
                <div class="form-group">
                    <label>Job Category *</label>
                    <select name="jobCategory" required>
                        <option value="">Select category</option>
                        <option>IT & Digital Economy</option>
                        <option>Marketing & Advertisements</option>
                        <option>Front Desk & Data Handlers</option>
                        <option>Management</option>
                        <option>Healthcare</option>
                        <option>Sales</option>
                        <option>Education</option>
                        <option>Engineering</option>
                        <option>Finance</option>
                        <option>Agriculture</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Experience Level *</label>
                    <select name="experience" required>
                        <option value="">Select level</option>
                        <option>Entry Level (0-2 years)</option>
                        <option>Mid Level (2-5 years)</option>
                        <option>Senior Level (5-10 years)</option>
                        <option>Executive Level (10+ years)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Key Skills *</label>
                    <textarea name="skills" rows="3" placeholder="List your relevant skills" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Work Experience *</label>
                    <textarea name="workExperience" rows="4" placeholder="Describe your relevant work experience" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Education *</label>
                    <textarea name="education" rows="3" placeholder="Your educational background" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Why are you interested in this position? *</label>
                    <textarea name="interest" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Availability *</label>
                    <select name="availability" required>
                        <option value="">Select availability</option>
                        <option>Immediately</option>
                        <option>Within 2 weeks</option>
                        <option>Within 1 month</option>
                        <option>To be discussed</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Submit Application</button>
            </form>
        </div>
    `;
}

// ===== COMMUNITY PROGRAMS MODAL =====
function createCommunityModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>ü§ù Join Community Programs</h2>
            
            <form onsubmit="processCommunityRegistration(event)">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" name="fullName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Location/Community *</label>
                    <input type="text" name="location" required>
                </div>
                
                <div class="form-group">
                    <label>Program Interest (Select all that apply) *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                        <label><input type="checkbox" name="programs" value="Agriculture"> Agriculture</label>
                        <label><input type="checkbox" name="programs" value="Climate"> Climate Action</label>
                        <label><input type="checkbox" name="programs" value="Environment"> Environment</label>
                        <label><input type="checkbox" name="programs" value="Water"> Water & Sanitation</label>
                        <label><input type="checkbox" name="programs" value="Education"> Education</label>
                        <label><input type="checkbox" name="programs" value="ChildCare"> Child Care</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Role Preference *</label>
                    <select name="role" required>
                        <option value="">How would you like to contribute?</option>
                        <option>Volunteer Worker</option>
                        <option>Community Organizer</option>
                        <option>Technical Advisor</option>
                        <option>Funding/Donor</option>
                        <option>Program Coordinator</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Available Time Commitment</label>
                    <select name="timeCommitment">
                        <option>2-4 hours per week</option>
                        <option>5-10 hours per week</option>
                        <option>10-20 hours per week</option>
                        <option>Full-time volunteer</option>
                        <option>Project-based</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Your Skills/Experience</label>
                    <textarea name="skills" rows="3" placeholder="What skills or experience can you contribute?"></textarea>
                </div>
                
                <button type="submit" class="btn">Join Community Programs</button>
            </form>
        </div>
    `;
}

// ===== CORPORATE REGISTRATION MODAL =====
function createCorporateModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üè¢ Corporate Registration - Valenta Holdings</h2>
            
            <div class="payment-info">
                <h3>Corporate Registration Package</h3>
                <p>Comprehensive business registration and setup services</p>
            </div>
            
            <form onsubmit="processCorporateRegistration(event)">
                <div class="form-group">
                    <label>Company Name *</label>
                    <input type="text" name="companyName" required>
                </div>
                
                <div class="form-group">
                    <label>Business Type *</label>
                    <select name="businessType" required>
                        <option value="">Select business type</option>
                        <option>Limited Company</option>
                        <option>Partnership</option>
                        <option>Sole Proprietorship</option>
                        <option>NGO/Foundation</option>
                        <option>Cooperative</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Industry Sector *</label>
                    <select name="sector" required>
                        <option value="">Select sector</option>
                        <option>Technology & Innovation</option>
                        <option>Agriculture & Food</option>
                        <option>Healthcare & Pharmaceuticals</option>
                        <option>Education & Training</option>
                        <option>Finance & Banking</option>
                        <option>Manufacturing</option>
                        <option>Retail & Commerce</option>
                        <option>Energy & Environment</option>
                        <option>Tourism & Hospitality</option>
                        <option>Media & Entertainment</option>
                        <option>Construction & Real Estate</option>
                        <option>Transportation & Logistics</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Training for Trade Program</label>
                    <select name="trainingTrade">
                        <option value="">Not applicable</option>
                        <option>Yes - Include training for employees</option>
                        <option>Yes - Include skills development</option>
                        <option>Yes - Include professional certification</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Contact Person *</label>
                    <input type="text" name="contactName" required>
                </div>
                
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" name="phone" required>
                </div>
                
                <div class="form-group">
                    <label>Country *</label>
                    <input type="text" name="country" required>
                </div>
                
                <div class="form-group">
                    <label>Business Address *</label>
                    <textarea name="address" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Business Description *</label>
                    <textarea name="businessDescription" rows="4" placeholder="Describe your business activities, products, services" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Expected Initial Investment (USD)</label>
                    <select name="investment">
                        <option value="">Select range</option>
                        <option>Under $10,000</option>
                        <option>$10,000 - $50,000</option>
                        <option>$50,000 - $100,000</option>
                        <option>$100,000 - $500,000</option>
                        <option>$500,000 - $1,000,000</option>
                        <option>Over $1,000,000</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Expected Number of Employees</label>
                    <select name="employees">
                        <option value="">Select range</option>
                        <option>1-5 employees</option>
                        <option>6-20 employees</option>
                        <option>21-50 employees</option>
                        <option>51-100 employees</option>
                        <option>100+ employees</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Pan-African Vision Alignment</label>
                    <textarea name="alignment" rows="3" placeholder="How does your business align with Pan-African development goals?"></textarea>
                </div>
                
                <button type="submit" class="btn">Submit Corporate Registration</button>
            </form>
        </div>
    `;
}

// ===== PAR SIRAI MODAL =====
function createParSiraiModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üèõÔ∏è Par Sirai Center</h2>
            <p>Center for Knowledge and Spirituality within AUFFI</p>
            
            <div style="padding: 20px;">
                <div style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                    <h3>Welcome to Par Sirai Center</h3>
                    <p>The spiritual and intellectual heart of Pan-African awakening</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üìö Knowledge Repository</h4>
                        <p>Access to Pan-African history, philosophy, and wisdom traditions</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üßò Spiritual Practices</h4>
                        <p>Meditation, prayer, and consciousness development programs</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üë• Community Circles</h4>
                        <p>Discussion groups and learning circles for spiritual growth</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                        <h4>üåü Awakening Programs</h4>
                        <p>Structured programs for social and spiritual consciousness</p>
                    </div>
                </div>
                
                <form onsubmit="processParSiraiRegistration(event)" style="margin-top: 30px;">
                    <div class="form-group">
                        <label>Name *</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label>Interest Area *</label>
                        <select name="interest" required>
                            <option value="">Select area</option>
                            <option>Pan-African Book of Oloo</option>
                            <option>Spiritual Life of Oloo</option>
                            <option>Philosophy & Wisdom of Oloo</option>
                            <option>African Community Leadership</option>
                            <option>African Cultural Heritage</option>
                        </select>
                    </div>
                    <button type="submit" class="btn">Join Par Sirai Center</button>
                </form>
            </div>
        </div>
    `;
}

// ===== TRUST GRAPH MODAL =====
function createTrustGraphModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üîó Trust Graph Ledger</h2>
            <div style="padding: 20px; text-align: center;">
                <div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 30px; border-radius: 15px; margin: 20px 0;">
                    <h3>Blockchain-Based Trust System</h3>
                    <p>Building transparent and verifiable trust networks across Africa</p>
                </div>
                <p style="margin: 20px 0;">The Trust Graph Ledger is currently in development. This system will enable:</p>
                <ul style="text-align: left; max-width: 500px; margin: 0 auto;">
                    <li>Verified identity and reputation tracking</li>
                    <li>Transparent transaction histories</li>
                    <li>Community-validated trust scores</li>
                    <li>Decentralized governance mechanisms</li>
                </ul>
            </div>
            
            <form onsubmit="processTrustGraphAccess(event)" id="trustGraphForm">
                <div class="form-group">
                    <label>Organization Name *</label>
                    <input type="text" name="organization" required>
                </div>
                <div class="form-group">
                    <label>Contact Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Access Level *</label>
                    <select name="accessLevel" required>
                        <option value="">Select level</option>
                        <option value="Basic">Basic Access</option>
                        <option value="Business">Corporate Access</option>
                        <option value="Enterprise">Sovereign Access</option>
                    </select>
                </div>
                <button type="submit" class="btn">Request Access</button>
            </form>
        </div>
    `;
}

// ===== FOUNDATION MODAL =====
function createFoundationModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üåç TAU Africa Foundation</h2>
            <div style="padding: 20px;">
                <div style="background: linear-gradient(45deg, #2ecc71, #27ae60); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                    <h3>Foundation for Sustainable Development</h3>
                    <p>Empowering African communities through strategic partnerships</p>
                </div>
                
                <form onsubmit="processFoundationInquiry(event)">
                    <div class="form-group">
                        <label>Organization/Individual Name *</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label>Inquiry Type *</label>
                        <select name="inquiryType" required>
                            <option value="">Select inquiry type</option>
                            <option>Grant Application</option>
                            <option>Partnership Opportunity</option>
                            <option>Donation/Contribution</option>
                            <option>Program Collaboration</option>
                            <option>General Information</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Message *</label>
                        <textarea name="message" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="btn">Submit Foundation Inquiry</button>
                </form>
            </div>
        </div>
    `;
}

// ===== HOLDINGS MODAL =====
function createHoldingsModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üè¢ Company Holdings</h2>
            <div style="padding: 20px;">
                <div style="background: linear-gradient(45deg, #9b59b6, #8e44ad); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                    <h3>Valenta Holdings Portfolio</h3>
                    <p>Strategic investments in African development</p>
                </div>
                
                <div style="display: grid; gap: 15px; margin: 20px 0;">
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                        <h4>Kabiru Digital Currency</h4>
                        <p>Revolutionary blockchain-based currency for African trade</p>
                    </div>
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                        <h4>AUFFI Community Network</h4>
                        <p>Pan-African social and spiritual unity platform</p>
                    </div>
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 10px;">
                        <h4>Agricultural Innovation Centers</h4>
                        <p>Modern farming techniques and food security</p>
                    </div>
                </div>
                
                <form onsubmit="processHoldingsInquiry(event)">
                    <div class="form-group">
                        <label>Name/Organization *</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label>Interest *</label>
                        <select name="interest" required>
                            <option value="">Select interest</option>
                            <option>Investment Opportunities</option>
                            <option>Partnership Proposals</option>
                            <option>Acquisition Inquiries</option>
                            <option>Joint Ventures</option>
                            <option>General Information</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Message *</label>
                        <textarea name="message" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="btn">Submit Holdings Inquiry</button>
                </form>
            </div>
        </div>
    `;
}

// ===== FORUM MODAL =====
function createForumModal() {
    return `
        <div class="modal-content">
            <span class="close" onclick="closeAllModals()">&times;</span>
            <h2>üí¨ Member Forum</h2>
            <p>Connect with fellow TAU Africa members</p>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>Forum Features:</h3>
                <ul style="text-align: left;">
                    <li>Discussion boards by topic</li>
                    <li>Job sharing and networking</li>
                    <li>Training materials access</li>
                    <li>Voice calls and messaging</li>
                    <li>Business collaboration</li>
                </ul>
                
                <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px;">
                    <strong>Notice:</strong> Forum access requires active TASK or TALK membership
                </div>
            </div>
            
            <div style="text-align: center;">
                <button class="btn" onclick="openModal('taskRegistration')">Join TASK Team</button>
                <button class="btn" onclick="openModal('talkRegistration')">Join TALK Team</button>
                <button class="btn" onclick="showMemberLogin()">Member Login</button>
            </div>
        </div>
    `;
}
</script>
    <script>
   // =====================================================
// TAU AFRICA DATABASE CONNECTION LAYER - COMPLETE
// =====================================================

(function() {
    'use strict';

    // Database Configuration
    const DB_CONFIG = {
        dbKey: 'tauAfricaDB',
        credentialsKey: 'tauCredentials',
        referralsKey: 'tauReferrals',
        jobsPortalKey: 'tauJobsPortal',
        sessionKey: 'tauCurrentUser',
        activitiesKey: 'tauActivities',
        tasksKey: 'tauTasks',
        forumsKey: 'tauForums'
    };

    // Member ID & Referral Code Generation
    function generateMemberID(team, referralCode = null) {
        const prefix = team === 'TASK' ? 'TSK' : team === 'TALK' ? 'TLK' : 'JOB';
        const timestamp = Date.now().toString().slice(-6);
        const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
        const id = `${prefix}-${timestamp}-${random}`;
        
        if (referralCode) {
            trackReferral(referralCode, id);
        }
        
        return id;
    }

    function generateReferralCode(memberId) {
        return btoa(memberId).substring(0, 8).toUpperCase();
    }

    // Referral Tracking with iKbp Rewards
    function trackReferral(referralCode, newMemberId) {
        try {
            const referrals = JSON.parse(localStorage.getItem(DB_CONFIG.referralsKey) || '{}');
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const referrer = members.find(m => m.referralCode === referralCode);
            
            if (referrer) {
                if (!referrals[referrer.id]) {
                    referrals[referrer.id] = {
                        memberId: referrer.id,
                        referredMembers: [],
                        totalEarnings: 0
                    };
                }
                
                const earnings = 500;
                referrals[referrer.id].referredMembers.push({
                    memberId: newMemberId,
                    date: new Date().toISOString(),
                    earnings: earnings
                });
                referrals[referrer.id].totalEarnings += earnings;
                
                localStorage.setItem(DB_CONFIG.referralsKey, JSON.stringify(referrals));
                updateMemberBalance(referrer.id, earnings);
                sendReferralNotification(referrer, earnings);
                
                console.log(`‚úÖ Referral tracked: ${referrer.id} earned ${earnings} iKbp`);
            }
        } catch (error) {
            console.error('Referral tracking error:', error);
        }
    }

    function updateMemberBalance(memberId, amount) {
        try {
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const memberIndex = members.findIndex(m => m.id === memberId);
            
            if (memberIndex !== -1) {
                members[memberIndex].iKbpBalance = (members[memberIndex].iKbpBalance || 0) + amount;
                localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(members));
                return true;
            }
            return false;
        } catch (error) {
            console.error('Balance update error:', error);
            return false;
        }
    }

    function sendReferralNotification(referrer, earnings) {
        const templateParams = {
            to_email: referrer.email,
            to_name: referrer.fullName,
            subject: 'üéâ Referral Bonus Earned - TAU Africa',
            message: `Congratulations ${referrer.fullName}!\n\nYou've earned ${earnings} iKbp (${earnings/10} KSH) from your referral.\n\nTotal Referral Earnings: ${getReferralEarnings(referrer.id)} iKbp\nCurrent Balance: ${referrer.iKbpBalance || 0} iKbp\n\nKeep sharing your referral code: ${referrer.referralCode}\n\nThank you for building TAU Africa!`,
            from_name: 'TAU Africa',
            from_email: 'grouptauafrica@gmail.com',
            phone: referrer.phone || 'Not provided',
            location: referrer.location || 'Not provided'
        };
        
        if (typeof emailjs !== 'undefined') {
            emailjs.send('service_xfira7g', 'template_bqxztig', templateParams)
                .then(() => console.log('‚úÖ Referral notification sent'))
                .catch(err => console.error('Referral email error:', err));
        }
    }

    function getReferralEarnings(memberId) {
        const referrals = JSON.parse(localStorage.getItem(DB_CONFIG.referralsKey) || '{}');
        return referrals[memberId]?.totalEarnings || 0;
    }

    function checkReferralCode() {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get('ref');
    }

    // Enhanced syncToDatabase Function
    function syncToDatabase(formData, team, referralCode = null) {
        try {
            const existingMembers = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            
            const memberId = generateMemberID(team, referralCode);
            const memberReferralCode = generateReferralCode(memberId);
            
            const member = {
                id: memberId,
                referralCode: memberReferralCode,
                team: team,
                fullName: formData.fullName || formData.name,
                email: formData.email,
                phone: formData.phone,
                location: formData.location,
                paymentStatus: 'Paid',
                dateJoined: new Date().toISOString().split('T')[0],
                status: 'Active',
                fee: team === 'TASK' ? 500 : team === 'TALK' ? 2000 : 1500,
                accountCreated: new Date().toISOString(),
                lastLogin: null,
                activities: [],
                tasks: [],
                jobs: [],
                forumPosts: [],
                iKbpBalance: 0,
                referredBy: referralCode || null
            };
            
            Object.keys(formData).forEach(key => {
                if (!member[key]) {
                    member[key] = formData[key];
                }
            });
            
            existingMembers.push(member);
            localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(existingMembers));
            storeMemberCredentials(member);
            window.dispatchEvent(new CustomEvent('tauMemberAdded', { detail: member }));
            
            console.log('‚úÖ Member synced to database:', memberId);
            return { success: true, memberId, member };
            
        } catch (error) {
            console.error('‚ùå Database sync error:', error);
            return { success: false, error: error.message };
        }
    }

    function storeMemberCredentials(member) {
        const credentials = JSON.parse(localStorage.getItem(DB_CONFIG.credentialsKey) || '{}');
        credentials[member.id] = {
            email: member.email,
            phone: member.phone.slice(-4),
            fullName: member.fullName
        };
        localStorage.setItem(DB_CONFIG.credentialsKey, JSON.stringify(credentials));
    }

    // Authentication
    function authenticateMember(identifier, phoneLastFour) {
        try {
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const member = members.find(m => 
                (m.id === identifier || m.email === identifier) && 
                m.phone.slice(-4) === phoneLastFour
            );
            
            if (member) {
                member.lastLogin = new Date().toISOString();
                const memberIndex = members.findIndex(m => m.id === member.id);
                members[memberIndex] = member;
                localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(members));
                sessionStorage.setItem(DB_CONFIG.sessionKey, JSON.stringify(member));
                return { success: true, member };
            }
            
            return { success: false, error: 'Invalid credentials' };
        } catch (error) {
            return { success: false, error: error.message };
        }
    }

    function getCurrentMember() {
        const sessionData = sessionStorage.getItem(DB_CONFIG.sessionKey);
        if (sessionData) {
            const member = JSON.parse(sessionData);
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const freshMember = members.find(m => m.id === member.id);
            if (freshMember) {
                sessionStorage.setItem(DB_CONFIG.sessionKey, JSON.stringify(freshMember));
                return freshMember;
            }
        }
        return null;
    }

    function logoutMember() {
        sessionStorage.removeItem(DB_CONFIG.sessionKey);
        return true;
    }

    // Activity Management
    function addMemberActivity(memberId, activity) {
        try {
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const memberIndex = members.findIndex(m => m.id === memberId);
            
            if (memberIndex !== -1) {
                const activityRecord = {
                    id: `ACT-${Date.now()}`,
                    type: activity.type,
                    title: activity.title,
                    description: activity.description,
                    dateAdded: new Date().toISOString(),
                    status: 'Active',
                    iKbpReward: activity.reward || 100
                };
                
                members[memberIndex].activities.push(activityRecord);
                members[memberIndex].iKbpBalance += activityRecord.iKbpReward;
                localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(members));
                
                return { 
                    success: true, 
                    activity: activityRecord,
                    newBalance: members[memberIndex].iKbpBalance,
                    earned: activityRecord.iKbpReward
                };
            }
            
            return { success: false, error: 'Member not found' };
        } catch (error) {
            return { success: false, error: error.message };
        }
    }

    // Task Management
    function addMemberTask(memberId, task) {
        try {
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const memberIndex = members.findIndex(m => m.id === memberId);
            
            if (memberIndex !== -1) {
                const taskRecord = {
                    id: `TSK-${Date.now()}`,
                    title: task.title,
                    description: task.description,
                    category: task.category,
                    dateAssigned: new Date().toISOString(),
                    dueDate: task.dueDate || null,
                    status: 'Assigned',
                    iKbpReward: task.reward || 200,
                    completedDate: null
                };
                
                members[memberIndex].tasks.push(taskRecord);
                localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(members));
                return { success: true, task: taskRecord };
            }
            
            return { success: false, error: 'Member not found' };
        } catch (error) {
            return { success: false, error: error.message };
        }
    }

    function completeTask(memberId, taskId) {
        try {
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const memberIndex = members.findIndex(m => m.id === memberId);
            
            if (memberIndex !== -1) {
                const task = members[memberIndex].tasks.find(t => t.id === taskId);
                
                if (task && task.status !== 'Completed') {
                    task.status = 'Completed';
                    task.completedDate = new Date().toISOString();
                    members[memberIndex].iKbpBalance += task.iKbpReward;
                    localStorage.setItem(DB_CONFIG.dbKey, JSON.stringify(members));
                    
                    return { 
                        success: true, 
                        task, 
                        newBalance: members[memberIndex].iKbpBalance,
                        earned: task.iKbpReward
                    };
                }
            }
            
            return { success: false, error: 'Task not found or already completed' };
        } catch (error) {
            return { success: false, error: error.message };
        }
    }

    // Forum Management
    function createForumPost(memberId, post) {
        try {
            const forums = JSON.parse(localStorage.getItem(DB_CONFIG.forumsKey) || '[]');
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const member = members.find(m => m.id === memberId);
            
            if (member) {
                const forumPost = {
                    id: `POST-${Date.now()}`,
                    authorId: memberId,
                    authorName: member.fullName,
                    authorTeam: member.team,
                    title: post.title,
                    content: post.content,
                    category: post.category,
                    datePosted: new Date().toISOString(),
                    likes: 0,
                    comments: [],
                    iKbpEarned: 50
                };
                
                forums.push(forumPost);
                localStorage.setItem(DB_CONFIG.forumsKey, JSON.stringify(forums));
                updateMemberBalance(memberId, 50);
                
                return { success: true, post: forumPost, earned: 50 };
            }
            
            return { success: false, error: 'Member not found' };
        } catch (error) {
            return { success: false, error: error.message };
        }
    }

    function getForumPosts(filters = {}) {
        try {
            let posts = JSON.parse(localStorage.getItem(DB_CONFIG.forumsKey) || '[]');
            
            if (filters.category) {
                posts = posts.filter(p => p.category === filters.category);
            }
            if (filters.authorId) {
                posts = posts.filter(p => p.authorId === filters.authorId);
            }
            
            posts.sort((a, b) => new Date(b.datePosted) - new Date(a.datePosted));
            return { success: true, posts };
        } catch (error) {
            return { success: false, error: error.message };
        }
    }

    function addForumComment(postId, memberId, comment) {
        try {
            const forums = JSON.parse(localStorage.getItem(DB_CONFIG.forumsKey) || '[]');
            const members = JSON.parse(localStorage.getItem(DB_CONFIG.dbKey) || '[]');
            const member = members.find(m => m.id === memberId);
            const post = forums.find(p => p.id === postId);
            
            if (post && member) {
                const commentObj = {
                    id: `CMT-${Date.now()}`,
                    authorId: memberId,
                    authorName: member.fullName,
                    content: comment,
                    datePosted: new Date().toISOString()
                };
                
                post.comments.push(commentObj);
                localStorage.setItem(DB_CONFIG.forumsKey, JSON.stringify(forums));
                updateMemberBalance(memberId, 10);
                
                return { success: true, comment: commentObj, earned: 10 };
            }
            
            return { success: false, error: 'Post or member not found' };
        } catch (error) {
            return { success: false, error: error.message };
        }
    }

        // Welcome Email
    function sendWelcomeEmail(member) {
        const templateParams = {
            to_email: member.email,
            to_name: member.fullName,
            subject: 'üéâ Welcome to TAU Africa',
            message: `Welcome ${member.fullName}!\n\nMember ID: ${member.id}\nReferral Code: ${member.referralCode}\n\nLogin: ${window.location.origin}\n\nEarn iKbp by:\n- Referring members: 500 iKbp\n- Completing tasks: 100-500 iKbp\n- Forum posts: 50 iKbp\n\nBalance: ${member.iKbpBalance} iKbp`,
            from_name: 'TAU Africa',
            from_email: 'grouptauafrica@gmail.com',
            phone: member.phone,
            location: member.location
        };
        
        return emailjs.send('service_xfira7g', 'template_bqxztig', templateParams);
    }

    // Override Success Handlers
    window.processTaskSuccess = function(formData) {
        const referralCode = checkReferralCode();
        const syncResult = syncToDatabase(formData, 'TASK', referralCode);
        
        if (syncResult.success) {
            const member = syncResult.member;
            sendWelcomeEmail(member);
            if (typeof sendEmailToOrganization === 'function') {
                sendEmailToOrganization(formData, 'NEW TASK REGISTRATION');
            }
            if (typeof showNotification === 'function') {
                showNotification(`‚úÖ Registration Complete!\nMember ID: ${member.id}\nReferral Code: ${member.referralCode}`, 'success');
            }
            setTimeout(() => {
                if (typeof showSuccessModal === 'function') showSuccessModal(member);
                if (typeof closeAllModals === 'function') closeAllModals();
            }, 2000);
        }
    };

    window.processTalkSuccess = function(formData) {
        const referralCode = checkReferralCode();
        const syncResult = syncToDatabase(formData, 'TALK', referralCode);
        
        if (syncResult.success) {
            const member = syncResult.member;
            sendWelcomeEmail(member);
            if (typeof sendEmailToOrganization === 'function') {
                sendEmailToOrganization(formData, 'NEW TALK REGISTRATION');
            }
            if (typeof showNotification === 'function') {
                showNotification(`‚úÖ Registration Complete!\nMember ID: ${member.id}\nReferral Code: ${member.referralCode}`, 'success');
            }
            setTimeout(() => {
                if (typeof showSuccessModal === 'function') showSuccessModal(member);
                if (typeof closeAllModals === 'function') closeAllModals();
            }, 2000);
        }
    };

    window.processJobCreationSuccess = function(formData) {
        const referralCode = checkReferralCode();
        const syncResult = syncToDatabase(formData, 'JOB_CREATION', referralCode);
        
        if (syncResult.success) {
            const member = syncResult.member;
            sendWelcomeEmail(member);
            if (typeof sendEmailToOrganization === 'function') {
                sendEmailToOrganization(formData, 'JOB CREATION ENROLLMENT');
            }
            if (typeof showNotification === 'function') {
                showNotification(`‚úÖ Enrollment Complete!\nMember ID: ${member.id}`, 'success');
            }
            setTimeout(() => {
                if (typeof showSuccessModal === 'function') showSuccessModal(member);
                if (typeof closeAllModals === 'function') closeAllModals();
            }, 2000);
        }
    };

    // Export API
    window.TauDB = {
        sync: syncToDatabase,
        authenticate: authenticateMember,
        getCurrentMember: getCurrentMember,
        logout: logoutMember,
        addActivity: addMemberActivity,
        addTask: addMemberTask,
        completeTask: completeTask,
        createForumPost: createForumPost,
        getForumPosts: getForumPosts,
        addForumComment: addForumComment,
        getReferralEarnings: getReferralEarnings,
        checkReferralCode: checkReferralCode,
        sendWelcomeEmail: sendWelcomeEmail,
        updateBalance: updateMemberBalance
    };

    console.log('‚úÖ TAU DATABASE CONNECTOR LOADED');
    
    const ref = checkReferralCode();
    if (ref && typeof showNotification === 'function') {
        showNotification(`üéÅ Referral code: ${ref} - Referrer earns 500 iKbp when you register!`, 'info', 8000);
    }
})(); 
    </script>

    <script>
    // =====================================================
// TAU AFRICA UI COMPONENTS - COMPLETE
// =====================================================

(function() {
    'use strict';

    // FORUM MODAL - COMPLETE
    window.createForumModal = function() {
        const currentMember = window.TauDB.getCurrentMember();
        
        if (!currentMember) {
            return `
                <div class="modal-content">
                    <span class="close" onclick="closeAllModals()">&times;</span>
                    <h2 style="color: #2a5298;">üí¨ Member Forum</h2>
                    <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <p><strong>‚ö†Ô∏è Login Required</strong></p>
                        <p>Please login to access forum.</p>
                    </div>
                    <button class="btn" onclick="closeAllModals(); showRealMemberLogin()">Login</button>
                </div>
            `;
        }

        const forumResult = window.TauDB.getForumPosts();
        const posts = forumResult.success ? forumResult.posts : [];

        return `
            <div class="modal-content" style="max-width: 900px;">
                <span class="close" onclick="closeAllModals()">&times;</span>
                
                <div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <h2 style="margin: 0;">üí¨ TAU Africa Forum</h2>
                    <p style="margin: 10px 0 0 0;">Welcome, ${currentMember.fullName}!</p>
                </div>

                <button class="btn" onclick="showCreatePostModal()" style="width: 100%; margin-bottom: 20px;">
                    ‚úçÔ∏è Create Post (Earn 50 iKbp)
                </button>

                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="btn btn-small" onclick="filterForumPosts('all')">All Posts</button>
                    <button class="btn btn-small" onclick="filterForumPosts('General')">General</button>
                    <button class="btn btn-small" onclick="filterForumPosts('Job Sharing')">Jobs</button>
                    <button class="btn btn-small" onclick="filterForumPosts('Training')">Training</button>
                </div>

                <div id="forumPostsList" style="max-height: 500px; overflow-y: auto;">
                    ${posts.length > 0 ? posts.map(post => `
                        <div style="background: white; border: 2px solid #eee; border-radius: 10px; padding: 20px; margin-bottom: 15px;">
                            <h3 style="margin: 0 0 10px 0; color: #2a5298;">${post.title}</h3>
                            <p style="margin: 0 0 10px 0; font-size: 0.9rem; color: #666;">
                                By <strong>${post.authorName}</strong> (${post.authorTeam}) ‚Ä¢ 
                                ${new Date(post.datePosted).toLocaleDateString()}
                            </p>
                            <span style="background: #667eea; color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.8rem;">${post.category}</span>
                            <p style="margin: 15px 0;">${post.content}</p>
                            <div style="display: flex; gap: 15px; margin-top: 10px;">
                                <button class="btn btn-small" onclick="showComments('${post.id}')">üí¨ Comments (${post.comments ? post.comments.length : 0})</button>
                                <button class="btn btn-small" onclick="addCommentToPost('${post.id}')">Add Comment (+10 iKbp)</button>
                            </div>
                            <div id="comments-${post.id}" style="display: none; margin-top: 15px;">
                                ${post.comments && post.comments.length > 0 ? post.comments.map(c => `
                                    <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin: 10px 0;">
                                        <p style="margin: 0; font-size: 0.85rem; color: #666;"><strong>${c.authorName}</strong></p>
                                        <p style="margin: 5px 0 0 0;">${c.content}</p>
                                    </div>
                                `).join('') : '<p>No comments yet.</p>'}
                            </div>
                        </div>
                    `).join('') : '<p style="text-align: center; padding: 40px;">No posts yet. Be the first!</p>'}
                </div>
            </div>
        `;
    };

    window.showCreatePostModal = function() {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'block';
        modal.innerHTML = `
            <div class="modal-content">
                <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
                <h2>Create Forum Post</h2>
                
                <form onsubmit="submitForumPost(event)">
                    <div class="form-group">
                        <label>Title *</label>
                        <input type="text" name="title" required maxlength="100">
                    </div>
                    
                    <div class="form-group">
                        <label>Category *</label>
                        <select name="category" required>
                            <option value="">Select category</option>
                            <option value="General">General Discussion</option>
                            <option value="Job Sharing">Job Sharing</option>
                            <option value="Training">Training</option>
                            <option value="Business">Business</option>
                            <option value="Questions">Questions</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Content *</label>
                        <textarea name="content" rows="6" required maxlength="2000"></textarea>
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%;">Post & Earn 50 iKbp</button>
                </form>
            </div>
        `;
        document.body.appendChild(modal);
    };

    window.submitForumPost = function(event) {
        event.preventDefault();
        const currentMember = window.TauDB.getCurrentMember();
        if (!currentMember) return;
        
        const formData = new FormData(event.target);
        const result = window.TauDB.createForumPost(currentMember.id, {
            title: formData.get('title'),
            category: formData.get('category'),
            content: formData.get('content')
        });
        
        if (result.success) {
            showNotification(`‚úÖ Post created! You earned ${result.earned} iKbp!`, 'success');
            closeAllModals();
            openModal('forum');
        }
    };

    window.filterForumPosts = function(category) {
        const filters = category === 'all' ? {} : { category: category };
        const result = window.TauDB.getForumPosts(filters);
        
        if (result.success) {
            const listContainer = document.getElementById('forumPostsList');
            if (listContainer) {
                listContainer.innerHTML = result.posts.length > 0 ? result.posts.map(post => `
                    <div style="background: white; border: 2px solid #eee; border-radius: 10px; padding: 20px; margin-bottom: 15px;">
                        <h3 style="margin: 0 0 10px 0;">${post.title}</h3>
                        <p style="margin: 0 0 10px 0; font-size: 0.9rem; color: #666;">
                            By <strong>${post.authorName}</strong> ‚Ä¢ ${new Date(post.datePosted).toLocaleDateString()}
                        </p>
                        <span style="background: #667eea; color: white; padding: 5px 10px; border-radius: 5px;">${post.category}</span>
                        <p style="margin: 15px 0;">${post.content}</p>
                    </div>
                `).join('') : '<p>No posts in this category.</p>';
            }
        }
    };

    window.showComments = function(postId) {
        const div = document.getElementById(`comments-${postId}`);
        if (div) div.style.display = div.style.display === 'none' ? 'block' : 'none';
    };

    window.addCommentToPost = function(postId) {
        const currentMember = window.TauDB.getCurrentMember();
        if (!currentMember) return;
        
        const comment = prompt('Enter your comment:');
        if (comment && comment.trim()) {
            const result = window.TauDB.addForumComment(postId, currentMember.id, comment.trim());
            if (result.success) {
                showNotification(`‚úÖ Comment added! Earned ${result.earned} iKbp!`, 'success');
                openModal('forum');
            }
        }
    };

    // ACTIVITIES MODAL - COMPLETE
    window.createActivitiesModal = function() {
        const currentMember = window.TauDB.getCurrentMember();
        
        if (!currentMember) {
            return `
                <div class="modal-content">
                    <span class="close" onclick="closeAllModals()">&times;</span>
                    <h2>üìö Activities</h2>
                    <p>Login required</p>
                    <button class="btn" onclick="closeAllModals(); showRealMemberLogin()">Login</button>
                </div>
            `;
        }

        return `
            <div class="modal-content" style="max-width: 800px;">
                <span class="close" onclick="closeAllModals()">&times;</span>
                
                <div style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <h2 style="margin: 0;">üìö Your Activities</h2>
                    <p style="margin: 10px 0 0 0;">Track contributions & earn iKbp!</p>
                </div>

                <button class="btn" onclick="showAddActivityModal()" style="width: 100%; margin-bottom: 20px;">
                    ‚ûï Add Activity (Earn 100 iKbp)
                </button>

                <div style="max-height: 400px; overflow-y: auto;">
                    ${currentMember.activities && currentMember.activities.length > 0 ? 
                        currentMember.activities.map(activity => `
                            <div style="background: white; border: 2px solid #eee; border-radius: 10px; padding: 20px; margin-bottom: 15px;">
                                <h3 style="margin: 0 0 10px 0;">${activity.title || activity.type}</h3>
                                <p style="margin: 0 0 10px 0;">${activity.description}</p>
                                <p style="margin: 0; font-size: 0.9rem; color: #666;">
                                    Added: ${new Date(activity.dateAdded).toLocaleDateString()} ‚Ä¢ 
                                    <strong style="color: #ffd700;">+${activity.iKbpReward} iKbp</strong>
                                </p>
                            </div>
                        `).join('')
                        : '<p style="text-align: center; padding: 40px;">No activities yet.</p>'
                    }
                </div>

                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-top: 20px;">
                    <p><strong>Balance:</strong> ${currentMember.iKbpBalance} iKbp</p>
                </div>
            </div>
        `;
    };

    window.showAddActivityModal = function() {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'block';
        modal.innerHTML = `
            <div class="modal-content">
                <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
                <h2>Add Activity</h2>
                
                <form onsubmit="submitActivity(event)">
                    <div class="form-group">
                        <label>Activity Type *</label>
                        <select name="type" required>
                            <option value="">Select type</option>
                            <option value="Training">Training/Workshop</option>
                            <option value="Community Service">Community Service</option>
                            <option value="Mentoring">Mentoring</option>
                            <option value="Skill Development">Skill Development</option>
                            <option value="Business">Business Activity</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Title *</label>
                        <input type="text" name="title" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Description *</label>
                        <textarea name="description" rows="4" required></textarea>
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%;">Add & Earn 100 iKbp</button>
                </form>
            </div>
        `;
        document.body.appendChild(modal);
    };

    window.submitActivity = function(event) {
        event.preventDefault();
        const currentMember = window.TauDB.getCurrentMember();
        if (!currentMember) return;
        
        const formData = new FormData(event.target);
        const result = window.TauDB.addActivity(currentMember.id, {
            type: formData.get('type'),
            title: formData.get('title'),
            description: formData.get('description'),
            reward: 100
        });
        
        if (result.success) {
            showNotification(`‚úÖ Activity added! Earned ${result.earned} iKbp! Balance: ${result.newBalance} iKbp`, 'success');
            closeAllModals();
            setTimeout(() => openModal('activities'), 500);
        }
    };

    // TASKS MODAL - COMPLETE
    window.createTasksModal = function() {
        const currentMember = window.TauDB.getCurrentMember();
        
        if (!currentMember) {
            return `
                <div class="modal-content">
                    <span class="close" onclick="closeAllModals()">&times;</span>
                    <h2>‚úÖ Tasks</h2>
                    <p>Login required</p>
                    <button class="btn" onclick="closeAllModals(); showRealMemberLogin()">Login</button>
                </div>
            `;
        }

        const activeTasks = currentMember.tasks ? currentMember.tasks.filter(t => t.status !== 'Completed') : [];
        const completedTasks = currentMember.tasks ? currentMember.tasks.filter(t => t.status === 'Completed') : [];

        return `
            <div class="modal-content" style="max-width: 900px;">
                <span class="close" onclick="closeAllModals()">&times;</span>
                
                <div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <h2 style="margin: 0;">‚úÖ Your Tasks</h2>
                </div>

                <h3 style="margin-bottom: 15px;">Active Tasks (${activeTasks.length})</h3>
                <div style="max-height: 300px; overflow-y: auto; margin-bottom: 30px;">
                    ${activeTasks.length > 0 ? 
                        activeTasks.map(task => `
                            <div style="background: white; border: 2px solid #4169e1; border-radius: 10px; padding: 20px; margin-bottom: 15px;">
                                <h3 style="margin: 0 0 10px 0;">${task.title}</h3>
                                <p style="margin: 0 0 10px 0;">${task.description}</p>
                                <p style="margin: 0 0 10px 0; font-size: 0.9rem; color: #666;">
                                    Category: ${task.category} ‚Ä¢ Reward: <strong style="color: #ffd700;">${task.iKbpReward} iKbp</strong>
                                </p>
                                <button class="btn btn-success" onclick="markTaskComplete('${task.id}')">‚úì Complete Task</button>
                            </div>
                        `).join('')
                        : '<p style="text-align: center; padding: 40px;">No active tasks.</p>'
                    }
                </div>

                <h3 style="margin-bottom: 15px;">Completed Tasks (${completedTasks.length})</h3>
                <div style="max-height: 200px; overflow-y: auto;">
                    ${completedTasks.length > 0 ? 
                        completedTasks.map(task => `
                            <div style="background: #f8f9fa; border: 2px solid #2ecc71; border-radius: 10px; padding: 15px; margin-bottom: 10px;">
                                <h4 style="margin: 0;">${task.title}</h4>
                                <p style="margin: 5px 0 0 0; font-size: 0.9rem; color: #666;">
                                    Completed: ${new Date(task.completedDate).toLocaleDateString()} ‚Ä¢ 
                                    <strong style="color: #2ecc71;">+${task.iKbpReward} iKbp</strong>
                                </p>
                            </div>
                        `).join('')
                        : '<p>No completed tasks yet.</p>'
                    }
                </div>
            </div>
        `;
    };

    window.markTaskComplete = function(taskId) {
        const currentMember = window.TauDB.getCurrentMember();
        if (!currentMember) return;
        
        const confirmed = confirm('Mark this task as complete?');
        if (!confirmed) return;
        
        const result = window.TauDB.completeTask(currentMember.id, taskId);
        
        if (result.success) {
            showNotification(`üéâ Task completed! Earned ${result.earned} iKbp! Balance: ${result.newBalance} iKbp`, 'success');
            closeAllModals();
            setTimeout(() => openModal('tasks'), 500);
        }
    };

    // MEMBER LOGIN - COMPLETE
    window.showRealMemberLogin = function() {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'block';
        modal.innerHTML = `
            <div class="modal-content">
                <span class="close" onclick="this.parentElement.parentElement.remove()">&times;</span>
                <h2 style="text-align: center;">üîê Member Login</h2>
                
                <form onsubmit="processRealLogin(event)" style="margin-top: 30px;">
                    <div class="form-group">
                        <label>Member ID or Email *</label>
                        <input type="text" id="loginIdentifier" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Phone (Last 4 digits) *</label>
                        <input type="text" id="loginPhone" required maxlength="4" pattern="[0-9]{4}">
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%;">Login</button>
                </form>
                
                <div style="text-align: center; margin-top: 20px;">
                    <p>No account?</p>
                    <button class="btn btn-small" onclick="closeAllModals(); openModal('taskRegistration')">Join TASK</button>
                    <button class="btn btn-small" onclick="closeAllModals(); openModal('talkRegistration')">Join TALK</button>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    };

    window.processRealLogin = function(event) {
        event.preventDefault();
        
        const identifier = document.getElementById('loginIdentifier').value.trim();
        const phoneLastFour = document.getElementById('loginPhone').value.trim();
        
        const result = window.TauDB.authenticate(identifier, phoneLastFour);
        
        if (result.success) {
            showNotification('‚úÖ Login successful!', 'success');
            setTimeout(() => {
                closeAllModals();
                showRealMemberDashboard(result.member);
            }, 1000);
        } else {
            showNotification('‚ùå Invalid credentials', 'error');
        }
    };

    // MEMBER DASHBOARD - COMPLETE
    window.showRealMemberDashboard = function(member) {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'block';
        
        const currentMember = window.TauDB.getCurrentMember() || member;
        const referralEarnings = window.TauDB.getReferralEarnings(currentMember.id);
        
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 1200px;">
                <span class="close" onclick="window.TauDB.logout(); this.parentElement.parentElement.remove()">&times;</span>
                
                <div style="background: linear-gradient(45deg, #4169e1, #87ceeb); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h1 style="margin: 0;">Welcome, ${currentMember.fullName}! üëã</h1>
                    <p style="margin: 10px 0 0 0;">Member ID: ${currentMember.id} ‚Ä¢ Team: ${currentMember.team}</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: #ffd700; padding: 25px; border-radius: 15px; text-align: center;">
                        <h3>üí∞ Balance</h3>
                        <h1 style="font-size: 2.5rem;">${currentMember.iKbpBalance || 0}</h1>
                        <p>iKbp (${((currentMember.iKbpBalance || 0) / 10).toFixed(2)} KSH)</p>
                    </div>
                    
                    <div style="background: #667eea; color: white; padding: 25px; border-radius: 15px; text-align: center;">
                        <h3>‚úÖ Tasks</h3>
                        <h1 style="font-size: 2.5rem;">${currentMember.tasks ? currentMember.tasks.filter(t => t.status !== 'Completed').length : 0}</h1>
                        <button class="btn" onclick="closeAllModals(); openModal('tasks')" style="margin-top: 10px; width: 100%;">View</button>
                    </div>
                    
                    <div style="background: #ff6b6b; color: white; padding: 25px; border-radius: 15px; text-align: center;">
                        <h3>üìö Activities</h3>
                        <h1 style="font-size: 2.5rem;">${currentMember.activities ? currentMember.activities.length : 0}</h1>
                        <button class="btn" onclick="closeAllModals(); openModal('activities')" style="margin-top: 10px; width: 100%;">View</button>
                    </div>
                    
                    <div style="background: #2ecc71; color: white; padding: 25px; border-radius: 15px; text-align: center;">
                        <h3>üéÅ Referrals</h3>
                        <h1 style="font-size: 2.5rem;">${referralEarnings}</h1>
                        <p>iKbp Earned</p>
                    </div>
                </div>
                
                <div style="background: #667eea; color: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <h4>üéÅ Your Referral Code</h4>
                    <h1 style="letter-spacing: 3px;">${currentMember.referralCode}</h1>
                    <button class="btn" onclick="copyReferralLink('${currentMember.referralCode}')" style="background: white; color: #667eea; width: 100%;">Copy Link</button>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <button class="btn" onclick="closeAllModals(); openModal('forum')">üí¨ Forum</button>
                    <button class="btn" onclick="closeAllModals(); openModal('activities')">üìö Activities</button>
                    <button class="btn" onclick="closeAllModals(); openModal('tasks')">‚úÖ Tasks</button>
                    <button class="btn" onclick="window.open('https://magero1985.github.io/Kabiru-Mining-Portal-/', '_blank')">‚ö° Mining</button>
                </div>
            </div>
        `;
        
        document.body.appendChild(modal);
    };

    // SUCCESS MODAL - COMPLETE
    window.showSuccessModal = function(member) {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'block';
        modal.innerHTML = `
            <div class="modal-content">
                <h2 style="color: #2ecc71; text-align: center;">üéâ Registration Successful!</h2>
                
                <div style="background: #4169e1; color: white; padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center;">
                    <h3>Your Member ID</h3>
                    <h1 style="font-size: 2.5rem; letter-spacing: 2px;">${member.id}</h1>
                </div>
                
                <div style="background: #ffd700; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4 style="color: #333;">üí∞ Referral Code</h4>
                    <h2 style="color: #333; letter-spacing: 3px;">${member.referralCode}</h2>
                    <button class="btn" onclick="copyReferralLink('${member.referralCode}')" style="width: 100%;">Copy Link</button>
                    <p style="color: #333; margin-top: 10px;">Earn 500 iKbp per referral!</p>
                </div>
                
                <button class="btn" onclick="proceedToLogin()" style="width: 100%;">Access Account</button>
                <button class="btn" onclick="closeAllModals()" style="width: 100%; margin-top: 10px; background: #95a5a6;">Close</button>
            </div>
        `;
        document.body.appendChild(modal);
    };

    window.proceedToLogin = function() {
        closeAllModals();
        showRealMemberLogin();
    };

    // COPY REFERRAL LINK - COMPLETE
    window.copyReferralLink = function(referralCode) {
        const link = `${window.location.origin}${window.location.pathname}?ref=${referralCode}`;
        
        if (navigator.clipboard) {
            navigator.clipboard.writeText(link).then(() => {
                showNotification('‚úÖ Referral link copied! Share to earn 500 iKbp!', 'success');
            }).catch(() => {
                prompt('Copy your referral link:', link);
            });
        } else {
            prompt('Copy your referral link:', link);
        }
    };

    // OVERRIDE EXISTING FUNCTIONS
    window.showMemberLogin = function() {
        showRealMemberLogin();
    };

    const originalGetModalContent = window.getModalContent;
    window.getModalContent = function(type) {
        switch(type) {
            case 'forum':
                return createForumModal();
            case 'activities':
                return createActivitiesModal();
            case 'tasks':
                return createTasksModal();
            default:
                return originalGetModalContent ? originalGetModalContent(type) : 
                    '<div class="modal-content"><span class="close" onclick="closeAllModals()">&times;</span><h2>Coming Soon</h2></div>';
        }
    };

    console.log('‚úÖ TAU UI COMPONENTS LOADED - COMPLETE');
})();
</script>
    <script>
// ============================================
// TAU AFRICA - WELCOME BONUS SOCKET
// ============================================
(function() {
    'use strict';
    
    function initWelcomeBonusSystem() {
        const DB_KEY = 'tauAfricaDB';
        const BONUS_KEY = 'tauWelcomeBonuses';
        const BONUS_AMOUNT = 500;
        
        function checkAndAwardBonuses() {
            try {
                const members = JSON.parse(localStorage.getItem(DB_KEY) || '[]');
                const bonusTracking = JSON.parse(localStorage.getItem(BONUS_KEY) || '{}');
                let newBonuses = 0;
                
                members.forEach(member => {
                    if (!bonusTracking[member.id]) {
                        // Award welcome bonus
                        member.iKbpBalance = (member.iKbpBalance || 0) + BONUS_AMOUNT;
                        
                        // Track bonus
                        bonusTracking[member.id] = {
                            awarded: true,
                            amount: BONUS_AMOUNT,
                            date: new Date().toISOString(),
                            memberId: member.id,
                            memberName: member.fullName
                        };
                        
                        newBonuses++;
                        console.log(`‚úÖ Welcome bonus awarded: ${member.fullName} (+${BONUS_AMOUNT} iKbp)`);
                    }
                });
                
                if (newBonuses > 0) {
                    localStorage.setItem(DB_KEY, JSON.stringify(members));
                    localStorage.setItem(BONUS_KEY, JSON.stringify(bonusTracking));
                    console.log(`üéÅ Total new bonuses awarded: ${newBonuses}`);
                }
            } catch (error) {
                console.error('Welcome bonus error:', error);
            }
        }
        
        // Check every 5 seconds for new registrations
        setInterval(checkAndAwardBonuses, 5000);
        checkAndAwardBonuses(); // Initial check
        
        console.log('‚úÖ Welcome Bonus System initialized');
    }
    
    // Auto-initialize when DOM loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initWelcomeBonusSystem);
    } else {
        initWelcomeBonusSystem();
    }
})();
</script>
    <!-- Notification Bell Icon - Add to your header -->
<div id="tauNotificationBell" style="position: fixed; top: 20px; right: 80px; z-index: 1000;">
    <button onclick="openTauNotifications()" style="background: #667eea; color: white; border: none; padding: 12px; border-radius: 50%; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); position: relative;">
        üîî
        <span id="tauNotifBadge" style="display: none; position: absolute; top: -5px; right: -5px; background: red; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 10px; line-height: 20px; text-align: center;">0</span>
    </button>
</div>

<!-- Notification Panel -->
<div id="tauNotificationPanel" style="display: none; position: fixed; top: 70px; right: 20px; width: 350px; max-height: 500px; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 1000; overflow-y: auto;">
    <div style="padding: 20px; border-bottom: 2px solid #eee;">
        <h3 style="margin: 0;">üîî Notifications</h3>
    </div>
    <div id="tauNotificationList" style="padding: 10px;"></div>
</div>

<script>
// ============================================
// TAU AFRICA - NOTIFICATION SOCKET
// ============================================
(function() {
    'use strict';
    
    function initNotificationSystem() {
        const NOTIF_KEY = 'tauNotifications';
        
        window.openTauNotifications = function() {
            const panel = document.getElementById('tauNotificationPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            loadNotifications();
        };
        
        function loadNotifications() {
            const currentMember = window.TauDB?.getCurrentMember();
            if (!currentMember) {
                document.getElementById('tauNotificationList').innerHTML = 
                    '<p style="text-align: center; color: #666;">Please login to view notifications</p>';
                return;
            }
            
            const allNotifications = JSON.parse(localStorage.getItem(NOTIF_KEY) || '{}');
            const memberNotifs = allNotifications[currentMember.id] || [];
            const unreadCount = memberNotifs.filter(n => !n.read).length;
            
            // Update badge
            const badge = document.getElementById('tauNotifBadge');
            if (unreadCount > 0) {
                badge.style.display = 'block';
                badge.textContent = unreadCount;
            } else {
                badge.style.display = 'none';
            }
            
            // Render notifications
            const list = document.getElementById('tauNotificationList');
            if (memberNotifs.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No notifications yet</p>';
                return;
            }
            
            list.innerHTML = memberNotifs.map(notif => `
                <div style="padding: 15px; border-bottom: 1px solid #eee; background: ${notif.read ? '#fff' : '#f0f4ff'}; border-left: 4px solid ${notif.read ? '#ddd' : '#667eea'};">
                    <strong>${notif.title}</strong>
                    <p style="margin: 5px 0; font-size: 14px; color: #666;">${notif.message}</p>
                    <small style="color: #999;">${new Date(notif.timestamp).toLocaleString()}</small>
                    ${!notif.read ? `<button onclick="markNotificationRead('${notif.id}')" style="margin-top: 8px; background: #667eea; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">Mark as read</button>` : ''}
                </div>
            `).join('');
        }
        
        window.markNotificationRead = function(notifId) {
            const currentMember = window.TauDB?.getCurrentMember();
            if (!currentMember) return;
            
            const allNotifications = JSON.parse(localStorage.getItem(NOTIF_KEY) || '{}');
            if (allNotifications[currentMember.id]) {
                const notif = allNotifications[currentMember.id].find(n => n.id === notifId);
                if (notif) notif.read = true;
                localStorage.setItem(NOTIF_KEY, JSON.stringify(allNotifications));
                loadNotifications();
            }
        };
        
        // Check for new notifications every 10 seconds
        setInterval(() => {
            const currentMember = window.TauDB?.getCurrentMember();
            if (currentMember) {
                const allNotifications = JSON.parse(localStorage.getItem(NOTIF_KEY) || '{}');
                const memberNotifs = allNotifications[currentMember.id] || [];
                const unreadCount = memberNotifs.filter(n => !n.read).length;
                
                const badge = document.getElementById('tauNotifBadge');
                if (unreadCount > 0) {
                    badge.style.display = 'block';
                    badge.textContent = unreadCount;
                } else {
                    badge.style.display = 'none';
                }
            }
        }, 10000);
        
        console.log('‚úÖ Notification System initialized');
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initNotificationSystem);
    } else {
        initNotificationSystem();
    }
})();
</script>
    <script>
// ============================================
// TAU AFRICA - LIMITS ENFORCEMENT SOCKET
// ============================================
(function() {
    'use strict';
    
    const EARNING_LIMITS = {
        1: 2000,
        2: 5000,
        3: 11000,
        4: 23000
    };
    
    const WITHDRAWAL_LIMITS = {
        1: 10000,  // KSH 1,000
        2: 25000,  // KSH 2,500
        3: 35000,  // KSH 3,500
        4: 50000   // KSH 5,000
    };
    
    window.TauLimits = {
        checkEarningLimit: function(memberId, amount) {
            const members = JSON.parse(localStorage.getItem('tauAfricaDB') || '[]');
            const member = members.find(m => m.id === memberId);
            if (!member) return { allowed: false, reason: 'Member not found' };
            
            const level = member.level || 1;
            const today = new Date().toISOString().split('T')[0];
            const dailyEarnings = JSON.parse(localStorage.getItem('tauDailyEarnings') || '{}');
            
            if (!dailyEarnings[today]) dailyEarnings[today] = {};
            const todayEarned = dailyEarnings[today][memberId] || 0;
            
            const limit = EARNING_LIMITS[level];
            const remaining = limit - todayEarned;
            
            if (todayEarned + amount > limit) {
                return {
                    allowed: false,
                    reason: `Daily earning limit reached. Level ${level} max: ${limit} iKbp`,
                    earned: todayEarned,
                    limit: limit,
                    remaining: remaining
                };
            }
            
            // Update daily earnings
            dailyEarnings[today][memberId] = todayEarned + amount;
            localStorage.setItem('tauDailyEarnings', JSON.stringify(dailyEarnings));
            
            return {
                allowed: true,
                earned: todayEarned + amount,
                limit: limit,
                remaining: limit - (todayEarned + amount)
            };
        },
        
        checkWithdrawalLimit: function(memberId, amount) {
            const members = JSON.parse(localStorage.getItem('tauAfricaDB') || '[]');
            const member = members.find(m => m.id === memberId);
            if (!member) return { allowed: false, reason: 'Member not found' };
            
            const level = member.level || 1;
            const limit = WITHDRAWAL_LIMITS[level];
            
            if (amount > limit) {
                return {
                    allowed: false,
                    reason: `Exceeds daily withdrawal limit. Level ${level} max: ${limit} iKbp (KSH ${limit/10})`,
                    limit: limit,
                    limitKsh: limit / 10
                };
            }
            
            if (amount > (member.iKbpBalance || 0)) {
                return {
                    allowed: false,
                    reason: 'Insufficient balance',
                    balance: member.iKbpBalance || 0
                };
            }
            
            return { allowed: true, limit: limit, limitKsh: limit / 10 };
        },
        
        getLimits: function(level) {
            return {
                earningLimit: EARNING_LIMITS[level] || EARNING_LIMITS[1],
                withdrawalLimit: WITHDRAWAL_LIMITS[level] || WITHDRAWAL_LIMITS[1],
                withdrawalLimitKsh: (WITHDRAWAL_LIMITS[level] || WITHDRAWAL_LIMITS[1]) / 10
            };
        }
    };
    
    console.log('‚úÖ Limits Enforcement System initialized');
})();

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/service-worker.js')
    .then(() => console.log('‚úÖ PWA installed'))
    .catch(err => console.log('‚ùå PWA error:', err));
}
    </script>
</body>
    </html>
